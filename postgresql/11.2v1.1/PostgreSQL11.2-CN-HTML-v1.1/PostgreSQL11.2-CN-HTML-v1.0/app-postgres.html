<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>postgres</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="pgwaldump.html" title="pg_waldump" /><link rel="next" href="app-postmaster.html" title="postmaster" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center"><span xmlns="http://www.w3.org/1999/xhtml" class="application">postgres</span></th></tr><tr><td width="10%" align="left"><a accesskey="p" href="pgwaldump.html" title="pg_waldump">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="reference-server.html" title="PostgreSQL 服务器应用">上一级</a></td><th width="60%" align="center">PostgreSQL 服务器应用</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 11.2 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="app-postmaster.html" title="postmaster">下一页</a></td></tr></table><hr></hr></div><div class="refentry" id="APP-POSTGRES"><div class="titlepage"></div><a id="id-1.9.5.14.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle"><span class="application">postgres</span></span></h2><p>postgres — <span class="productname">PostgreSQL</span>数据库服务器</p></div><div class="refsynopsisdiv"><h2>大纲</h2><div class="cmdsynopsis"><p id="id-1.9.5.14.4.1"><code class="command">postgres</code> [<em class="replaceable"><code>选项</code></em>...]</p></div></div><div class="refsect1" id="id-1.9.5.14.5"><h2>描述</h2><p>
   <code class="command">postgres</code>是<span class="productname">PostgreSQL</span>数据库服务器。一个客户端应用为了能访问一个数据库，它会（通过一个网络或者本地）连接到一个运行着的<code class="command">postgres</code>实例。该<code class="command">postgres</code>实例接着会开始一个独立的服务器进程来处理该连接。
  </p><p>
   一个<code class="command">postgres</code>实例总是管理正好一个数据库集簇的数据。一个数据库集簇是一个数据库的集合，它们被存储在一个共同的文件系统位置（<span class="quote">“<span class="quote">数据区</span>”</span>）上。 一个系统上可以同时运行多个<code class="command">postgres</code>实例，只要它们使用不同的数据区和不同的通信端口（见下文）。<code class="command">postgres</code>启动时需要知道数据区的位置，该位置必须通过<code class="option">-D</code>选项或<code class="envar">PGDATA</code>环境变量指定，对此是没有默认值的。通常，<code class="option">-D</code>或<code class="envar">PGDATA</code>会直接指向由<a class="xref" href="app-initdb.html" title="initdb"><span class="refentrytitle">initdb</span></a>创建的数据区目录。其他可能的文件布局在<a class="xref" href="runtime-config-file-locations.html" title="19.2. 文件位置">第 19.2 节</a>中讨论。
  </p><p>
   默认情况下，<code class="command">postgres</code>会在前台启动并将日志消息打印到标准错误流。但在实际应用中，<code class="command">postgres</code>应当作为一个后台进程启动，而且多数是在系统启动时自动启动。
  </p><p>
   <code class="command">postgres</code>还能在单用户模式中被调用。这种模式的主要用途是在启动过程中由<a class="xref" href="app-initdb.html" title="initdb"><span class="refentrytitle">initdb</span></a>使用。有时候它也被用于调试或者灾难性恢复。注意，运行一个单用户模式服务器并不真地适合调试服务器，因为不会发生实际的进程间通信和锁定。当从 shell 中调用单用户模式时，用户可以输入查询并且结果会被以一种更适合开发者阅读（不适合普通用户）的形式打印在屏幕上。在单用户模式中，会话用户将被设置为 ID 为 1 的用户，并且这个用户会被隐式地赋予超级用户权限。该用户不必实际存在，因此单用户模式运行可以被用来对某些意外损坏的系统目录进行手工恢复。
  </p></div><div class="refsect1" id="APP-POSTGRES-OPTIONS"><h2>选项</h2><p>
    <code class="command">postgres</code>接受下列命令行参数。关于这些选项的详细讨论请参考<a class="xref" href="runtime-config.html" title="第 19 章 服务器配置">第 19 章</a>。你也可以通过设置一个配置文件来减少键入大部分这些选项。有些（安全）选项还可以从连接的客户端以一种与应用相关只应用于会话的方法设置。例如，如果设置了<code class="envar">PGOPTIONS</code>环境变量，那么基于<span class="application">libpq</span>的客户端将都把那个字符串传递给服务器，它将被服务器解释成<code class="command">postgres</code>命令行选项。
   </p><div class="refsect2" id="id-1.9.5.14.6.3"><h3>通用选项</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-B <em class="replaceable"><code>nbuffers</code></em></code></span></dt><dd><p>
        设置被服务器进程使用的共享内存缓冲区数量。这个参数的默认值是<span class="application">initdb</span>自动选择的。指定这个选项等效于设置<a class="xref" href="runtime-config-resource.html#GUC-SHARED-BUFFERS">shared_buffers</a>配置参数。
       </p></dd><dt><span class="term"><code class="option">-c <em class="replaceable"><code>name</code></em>=<em class="replaceable"><code>value</code></em></code></span></dt><dd><p>
        设置一个命名的运行时参数。<span class="productname">PostgreSQL</span>支持的配置参数在<a class="xref" href="runtime-config.html" title="第 19 章 服务器配置">第 19 章</a>中描述。大多数其它命令行选项实际上都是这种参数赋值的短形式。<code class="option">-c</code>可以出现多次用于设置多个参数。
       </p></dd><dt><span class="term"><code class="option">-C <em class="replaceable"><code>name</code></em></code></span></dt><dd><p>
        打印命名运行时参数的值，并且退出（详见上面的<code class="option">-c</code>选项）。这可以被用在一个运行服务器上，并且从<code class="filename">postgresql.conf</code>中返回值，这些值可能被在这次调用中的任何参数修改过。它并不反映集簇启动时提供的参数。
       </p><p>
        这个选项用于与一个服务器实例交互的其他程序来查询配置参数值，例如<a class="xref" href="app-pg-ctl.html" title="pg_ctl"><span class="refentrytitle"><span class="application">pg_ctl</span></span></a>。面向用户的应用应该使用<a class="xref" href="sql-show.html" title="SHOW"><span class="refentrytitle">SHOW</span></a>或者<code class="structname">pg_settings</code>视图。
       </p></dd><dt><span class="term"><code class="option">-d <em class="replaceable"><code>debug-level</code></em></code></span></dt><dd><p>
        设置调试级别。数值设置得越高，写到服务器日志的调试输出就越多。取值范围是从 1 到 5。还可以针对某个特定会话使用<code class="literal">-d 0</code>来阻止父<code class="command">postgres</code>进程的服务器日志级别被传播到这个会话。
       </p></dd><dt><span class="term"><code class="option">-D <em class="replaceable"><code>datadir</code></em></code></span></dt><dd><p>
        指定数据库配置文件的文件系统位置。详见<a class="xref" href="runtime-config-file-locations.html" title="19.2. 文件位置">第 19.2 节</a>。
       </p></dd><dt><span class="term"><code class="option">-e</code></span></dt><dd><p>
        把默认日期风格设置为<span class="quote">“<span class="quote">European</span>”</span>，也就是输入日期域的顺序是<code class="literal">DMY</code>。这也导致在一些日期输出格式中把日打印在月之前。详见<a class="xref" href="datatype-datetime.html" title="8.5. 日期/时间类型">第 8.5 节</a>。
       </p></dd><dt><span class="term"><code class="option">-F</code></span></dt><dd><p>
        禁用<code class="function">fsync</code>调用以提高性能，但是要冒系统崩溃时数据损坏的风险。指定这个选项等效于禁用<a class="xref" href="runtime-config-wal.html#GUC-FSYNC">fsync</a>配置参数。在使用之前阅读详细文档！
       </p></dd><dt><span class="term"><code class="option">-h <em class="replaceable"><code>hostname</code></em></code></span></dt><dd><p>
        指定<code class="command">postgres</code>监听来自客户端应用 TCP/IP 连接的 IP 主机名或地址。该值也可以是一个用逗号分隔的地址列表，或者<code class="literal">*</code>表示监听所有可用的地址。一个空值表示不监听任何 IP 地址，在这种情况下可以使用 Unix 域套接字连接到服务器。缺省只监听localhost。声明这个选项等效于设置listen_addresses配置参数。默认只监听<span class="systemitem">localhost</span>。指定这个选项等效于设置<a class="xref" href="runtime-config-connection.html#GUC-LISTEN-ADDRESSES">listen_addresses</a>配置参数。
       </p></dd><dt><span class="term"><code class="option">-i</code></span></dt><dd><p>
        允许远程客户端使用 TCP/IP （互联网域）连接。没有这个选项，将只接受本地连接。这个选项等效于在<code class="filename">postgresql.conf</code>中或者通过<code class="option">-h</code>选项将<code class="varname">listen_addresses</code>设为<code class="literal">*</code>。
       </p><p>
        这个选项已经被废弃，因为它不允许访问<a class="xref" href="runtime-config-connection.html#GUC-LISTEN-ADDRESSES">listen_addresses</a>的完整功能。所以最好直接设置<code class="varname">listen_addresses</code>。
       </p></dd><dt><span class="term"><code class="option">-k <em class="replaceable"><code>directory</code></em></code></span></dt><dd><p>
        指定<code class="command">postgres</code>用来监听来自客户端应用连接的 Unix 域套接字的目录。这个值也可以是一个逗号分隔的目录列表。一个空值指定不监听任何 Unix 域套接字，在这种情况下只能用 TCP/IP 套接字来连接到服务器。默认值通常是<code class="filename">/tmp</code>，但是可以在编译的时候修改。指定这个选项等效于设置<a class="xref" href="runtime-config-connection.html#GUC-UNIX-SOCKET-DIRECTORIES">unix_socket_directories</a>配置参数。
       </p></dd><dt><span class="term"><code class="option">-l</code></span></dt><dd><p>
        启用使用<acronym class="acronym">SSL</acronym>的安全连接。要使这个选项可用，编译<span class="productname">PostgreSQL</span>时必须打开<acronym class="acronym">SSL</acronym>支持。有关使用<acronym class="acronym">SSL</acronym>的更多信息，请参考<a class="xref" href="ssl-tcp.html" title="18.9. 用 SSL 进行安全的 TCP/IP 连接">第 18.9 节</a>。
       </p></dd><dt><span class="term"><code class="option">-N <em class="replaceable"><code>max-connections</code></em></code></span></dt><dd><p>
        设置该服务器将接受的最大客户端连接数。该参数的默认值由<span class="application">initdb</span>自动选择。指定这个选项等效于设置<a class="xref" href="runtime-config-connection.html#GUC-MAX-CONNECTIONS">max_connections</a>配置参数。
       </p></dd><dt><span class="term"><code class="option">-o <em class="replaceable"><code>extra-options</code></em></code></span></dt><dd><p>
        在<em class="replaceable"><code>extra-options</code></em>中指定的命令行风格的参数会被传递给所有由这个<code class="command">postgres</code>进程派生的服务进程。
       </p><p>
        <em class="replaceable"><code>extra-options</code></em>中的空格被视作
        参数分隔符，除非用反斜线（<code class="literal">\</code>）转义。要表示一个字面意
        义上的反斜线，可以写成<code class="literal">\\</code>。通过多次使用<code class="option">-o</code>
        也可以指定多个参数。
       </p><p>
        这个选项的使用已经被废弃。用于服务器进程的所有命令行选项可以在<code class="command">postgres</code>命令行上直接指定。
       </p></dd><dt><span class="term"><code class="option">-p <em class="replaceable"><code>port</code></em></code></span></dt><dd><p>
        指定<code class="command">postgres</code>用于监听客户端应用连接的 TCP/IP 端口或本地 Unix 域套接字文件扩展。默认为<code class="envar">PGPORT</code>环境变量的值。如果<code class="envar">PGPORT</code>没有设置，那么默认值是编译期间设立的值（通常是 5432）。如果你指定了一个非默认端口，那么所有客户端应用都必须用命令行选项或者<code class="envar">PGPORT</code>指定同一个端口。
       </p></dd><dt><span class="term"><code class="option">-s</code></span></dt><dd><p>
        在每条命令结束时打印时间信息和其它统计信息。这个选项对测试基准和调节缓冲区数量有用处。
       </p></dd><dt><span class="term"><code class="option">-S</code> <em class="replaceable"><code>work-mem</code></em></span></dt><dd><p>
        指定内部排序和散列在使用临时磁盘文件之前能使用的内存数量。见<a class="xref" href="runtime-config-resource.html#RUNTIME-CONFIG-RESOURCE-MEMORY" title="19.4.1. 内存">第 19.4.1 节</a>中对<code class="varname">work_mem</code>配置参数的描述。
       </p></dd><dt><span class="term"><code class="option">-V</code><br /></span><span class="term"><code class="option">--version</code></span></dt><dd><p>
        打印<span class="application">postgres</span>版本并退出。
       </p></dd><dt><span class="term"><code class="option">--<em class="replaceable"><code>name</code></em>=<em class="replaceable"><code>value</code></em></code></span></dt><dd><p>
        设置一个命名的运行时参数；其缩写形式是<code class="option">-c</code>。
       </p></dd><dt><span class="term"><code class="option">--describe-config</code></span></dt><dd><p>
        这个选项会用制表符分隔的<code class="command">COPY</code>格式导出服务器的内部配置变量、描述以及默认值。设计它的目的是用于管理工具。
       </p></dd><dt><span class="term"><code class="option">-?</code><br /></span><span class="term"><code class="option">--help</code></span></dt><dd><p>
        显示有关<span class="application">postgres</span>的命令行参数，并且退出。
       </p></dd></dl></div></div><div class="refsect2" id="id-1.9.5.14.6.4"><h3>半内部选项</h3><p>
     这里描述的选项主要被用于调试目的，并且在某些情况下可以协助恢复严重受损的数据库。在生产数据库环境中应该不会去使用它们。在这里列举它们只是为了让<span class="productname">PostgreSQL</span>系统开发者使用。此外，这些选项可能在将来的版本中更改或删除而不另行通知。
    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-f</code> <code class="literal">{ s | i | o | b | t | n | m | h }</code></span></dt><dd><p>
        禁止某种扫描和连接方法的使用：<code class="literal">s</code>和<code class="literal">i</code>分别禁用顺序和索引扫描， <code class="literal">o</code>、<code class="literal">b</code>和<code class="literal">t</code>分别禁用只用索引扫描、位图索引扫描以及 TID 扫描，而<code class="literal">n</code>、<code class="literal">m</code>和<code class="literal">h</code>则分别禁用嵌套循环、归并和哈希连接。
       </p><p>
        顺序扫描和嵌套循环连接都不可能完全被禁用。<code class="literal">-fs</code>和<code class="literal">-fn</code>选项仅仅是在有其他选择时不鼓励优化器使用这些计划类型。
       </p></dd><dt><span class="term"><code class="option">-n</code></span></dt><dd><p>
        该选项主要用于调试导致服务器进程异常崩溃的问题。对付这种情况的一般策略是通知所有其它服务器进程，让它们终止并且接着重新初始化共享内存和信号量。这是因为一个错误的服务器进程可能在终止之前就已经对共享状态造成了破坏。该选项指定<code class="command">postgres</code>将不会重新初始化共享数据结构。一个有经验的系统程序员这时就可以使用调试器检查共享内存和信号量状态。
       </p></dd><dt><span class="term"><code class="option">-O</code></span></dt><dd><p>
        允许修改系统表的结构。这个选项用于<code class="command">initdb</code>。
       </p></dd><dt><span class="term"><code class="option">-P</code></span></dt><dd><p>
        读取系统表时忽略系统索引（但在更改系统表时仍然更新索引）。这在从损坏的系统索引中恢复时有用。
       </p></dd><dt><span class="term"><code class="option">-t</code> <code class="literal">pa[rser] | pl[anner] | e[xecutor]</code></span></dt><dd><p>
        打印与每个主要系统模块相关的查询的时间统计。这个选项不能和<code class="option">-s</code>选项一起使用。
       </p></dd><dt><span class="term"><code class="option">-T</code></span></dt><dd><p>
        该选项主要用于调试导致服务器进程异常崩溃的问题。对付这种情况的一般策略是通知所有其它服务器进程，让它们终止并且接着重新初始化共享内存和信号量。这是因为一个错误的服务器进程可能在终止之前就已经对共享状态造成了破坏。该选项指定<code class="command">postgres</code>将通过发送<code class="literal">SIGSTOP</code>信号停止其他所有服务器进程，但是并不让它们终止。这样就允许系统程序员手动从所有服务器进程收集内核转储。
       </p></dd><dt><span class="term"><code class="option">-v</code> <em class="replaceable"><code>protocol</code></em></span></dt><dd><p>
        声明这次会话使用的前/后服务器协议的版本数。该选项仅在内部使用。
       </p></dd><dt><span class="term"><code class="option">-W</code> <em class="replaceable"><code>seconds</code></em></span></dt><dd><p>
        在一个新服务器进程被启动时，它实施认证过程之后会延迟这个选项所设置的秒数。这就留出了机会来用一个调试器附着在服务器进程上。
       </p></dd></dl></div></div><div class="refsect2" id="id-1.9.5.14.6.5"><h3>用于单用户模式的选项</h3><a id="id-1.9.5.14.6.5.2" class="indexterm"></a><p>
     下面的选项仅适用于单用户模式（见<a class="xref" href="app-postgres.html#APP-POSTGRES-SINGLE-USER" title="单用户模式">单用户模式</a>）。
    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">--single</code></span></dt><dd><p>
        选择单用户模式。这必须是命令行中的第一个选项。
       </p></dd><dt><span class="term"><em class="replaceable"><code>database</code></em></span></dt><dd><p>
        指定要访问的数据库的名称。这必须是命令行中的最后一个参数。如果省略它，则默认为用户名。
       </p></dd><dt><span class="term"><code class="option">-E</code></span></dt><dd><p>
        在执行命令之前回显所有命令到标准输出。
       </p></dd><dt><span class="term"><code class="option">-j</code></span></dt><dd><p>
        使用跟着两个新行的分号而不是仅用新行作为命令终止符。
       </p></dd><dt><span class="term"><code class="option">-r</code> <em class="replaceable"><code>filename</code></em></span></dt><dd><p>
        将所有服务器日志输出发送到<em class="replaceable"><code>filename</code></em>中。
        只有在作为一个命令行选项提供时，这个选项才会兑现。
       </p></dd></dl></div></div></div><div class="refsect1" id="id-1.9.5.14.7"><h2>环境</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="envar">PGCLIENTENCODING</code></span></dt><dd><p>
      客户端使用的默认字符编码（客户端可以独立地覆盖它）。这个值也可以在配置文件中设置。
     </p></dd><dt><span class="term"><code class="envar">PGDATA</code></span></dt><dd><p>
      默认的数据目录位置。
     </p></dd><dt><span class="term"><code class="envar">PGDATESTYLE</code></span></dt><dd><p>
      <a class="xref" href="runtime-config-client.html#GUC-DATESTYLE">DateStyle</a>运行时参数的默认值（这个环境变量的使用已被废弃）。
     </p></dd><dt><span class="term"><code class="envar">PGPORT</code></span></dt><dd><p>
      默认端口号（在配置文件中设置更好）
     </p></dd></dl></div></div><div class="refsect1" id="id-1.9.5.14.8"><h2>诊断</h2><p>
    一个提到了<code class="literal">semget</code>或<code class="literal">shmget</code>的错误消息可能意味着你需要配置内核来提供足够的共享内存和信号量。更多讨论请见<a class="xref" href="kernel-resources.html" title="18.4. 管理内核资源">第 18.4 节</a>。你也可以通过降低<a class="xref" href="runtime-config-resource.html#GUC-SHARED-BUFFERS">shared_buffers</a>值减少<span class="productname">PostgreSQL</span>的共享内存消耗， 或者降低<a class="xref" href="runtime-config-connection.html#GUC-MAX-CONNECTIONS">max_connections</a>值减少信号量消耗，这样可以推迟对内核的重新配置。
   </p><p>
    如果一个消息说另外一个服务器已经在运行，应该仔细地检查，例如根据你的系统可以用命令
</p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>ps ax | grep postgres</code></strong>
</pre><p>
        或
</p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>ps -ef | grep postgres</code></strong>
</pre><p>
    如果你确信没有冲突的服务器正在运行，那么你可以删除消息中提到的锁文件然后再次尝试。
   </p><p>
    如果一个失败消息指示它无法绑定到一个端口，可能意味着该端口已经被某些非<span class="productname">PostgreSQL</span>进程所使用。如果你终止<code class="command">postgres</code>并且立即使用相同的端口重启它，你也可能会得到这种错误。在这种情况系，你必须等待几秒直到操作系统关闭该端口，然后再重试。最后，如果你指定了一个操作系统认为需要保留的端口号，你可能也会得到这个错误。例如，很多版本的 Unix 认为低于 1024 的端口号是<span class="quote">“<span class="quote">可信的</span>”</span>并且只允许 Unix 超级用户访问它们。
   </p></div><div class="refsect1" id="id-1.9.5.14.9"><h2>注解</h2><p>
   实用命令<a class="xref" href="app-pg-ctl.html" title="pg_ctl"><span class="refentrytitle"><span class="application">pg_ctl</span></span></a>可以用来安全方便地启动和关闭<code class="command">postgres</code>服务器。
  </p><p>
   只要有可能，就<span class="emphasis"><em>不要</em></span>使用<code class="literal">SIGKILL</code>杀死主<code class="command">postgres</code>服务器。这样会阻止<code class="command">postgres</code>在终止前释放它持有的系统资源（例如共享内存和信号量）。这样可能会导致启动新的<code class="command">postgres</code>进程时出现问题。
  </p><p>
   要正常地终止<code class="command">postgres</code>服务器，可以使用<code class="literal">SIGTERM</code>、<code class="literal">SIGINT</code>或者<code class="literal">SIGQUIT</code>信号。第一个在退出前将等待所有客户端终止，第二个将强行断开所有客户端的连接，第三个会不做正确的关闭立即退出并且会导致重启时的恢复。
  </p><p>
   <code class="literal">SIGHUP</code>信号会重新加载服务器配置文件。也可以向一个单独的服务器进程发送<code class="literal">SIGHUP</code>信号，但是这样做通常没什么意义。
  </p><p>
   要取消一个正在运行的查询，可以向运行该查询的进程发送<code class="literal">SIGINT</code>信号。要干净地终止一个后端进程，可向它发送<code class="literal">SIGTERM</code>。在 SQL 中可调用的与这两种动作等效的命令可参考<a class="xref" href="functions-admin.html#FUNCTIONS-ADMIN-SIGNAL" title="9.26.2. 服务器信号函数">第 9.26.2 节</a>中的<code class="function">pg_cancel_backend</code>和<code class="function">pg_terminate_backend</code>。
  </p><p>
   <code class="command">postgres</code>服务器使用<code class="literal">SIGQUIT</code>来告诉子服务器进程终止但不做正常的清理。该信号<span class="emphasis"><em>不应该</em></span>被用户使用。向一个服务器进程发送<code class="literal">SIGKILL</code>也是不明智的 — 主<code class="command">postgres</code>进程将把这解释为一次崩溃，并且作为其标准崩溃恢复过程的一部分，它将强制所有的后代进程退出。
  </p></div><div class="refsect1" id="APP-POSTGRES-BUGS"><h2>缺陷</h2><p>
   <code class="option">--</code>选项在<span class="systemitem">FreeBSD</span>或<span class="systemitem">OpenBSD</span>上无法运行，应该使用<code class="option">-c</code>。这在受影响的系统里是个缺陷； 如果这个缺陷没有被修复，将来的<span class="productname">PostgreSQL</span>版本将提供一种解决方案。
  </p></div><div class="refsect1" id="APP-POSTGRES-SINGLE-USER"><h2>单用户模式</h2><p>
    要启动一个单用户模式的服务器，使用这样的命令
</p><pre class="screen">
<strong class="userinput"><code>postgres --single -D /usr/local/pgsql/data <em class="replaceable"><code>other-options</code></em> my_database</code></strong>
</pre><p>
    用<code class="option">-D</code>给服务器提供正确的数据库目录的路径，或者确保环境变量<code class="envar">PGDATA</code>被设置。同时还要指定你想在其中工作的特定数据库的名字。
   </p><p>
    通常，单用户模式的服务器会把换行符当做命令输入的终止符。它不明白分号的作用，因为那属于<span class="application">psql</span>。要想把一个命令分成多行，必须在最后一个换行符以外的每个换行符前面敲一个反斜线。这个反斜线和旁边的新行都会被从输入命令中去掉。注意即使在字符串或者注释中也会这样做。
   </p><p>
    但是如果使用了<code class="option">-j</code>命令行选项，那么单个新行将不会终止命令输入。相反，分号-新行-新行的序列才会终止命令输入。也就是说，输入一个紧跟着空行的分号。在这种模式下，反斜线-新行不会被特殊对待。此外，在字符串或者注释内的这类序列也不会被特殊对待。
   </p><p>
    不管在哪一种输入模式中，如果输入的一个分号不是正好在命令终止符之前或者不是命令终止符的一部分，它会被认为是一个命令分隔符。当真正输入一个命令终止符时，已经输入的多个语句将被作为一个单个事务执行。
   </p><p>
    要退出会话，输入<acronym class="acronym">EOF</acronym>（通常是<span class="keycap"><strong>Control</strong></span>+<span class="keycap"><strong>D</strong></span>）。如果从上一个命令终止符以来已经输入了任何文本，那么<acronym class="acronym">EOF</acronym>将被当作命令终止符，并且如果要退出则需要另一个<acronym class="acronym">EOF</acronym>。
   </p><p>
    请注意单用户模式的服务器不会提供复杂的行编辑特性（例如没有命令历史）。但用户模式也不会做任何后台处理，例如自动检查点或者复制。

   </p></div><div class="refsect1" id="APP-POSTGRES-EXAMPLES"><h2>例子</h2><p>
   要用默认值在后台启动<code class="command">postgres</code>：

</p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>nohup postgres &gt;logfile 2&gt;&amp;1 &lt;/dev/null &amp;</code></strong>
</pre><p>
  </p><p>
   要用指定端口启动<code class="command">postgres</code>，例如 1234：
</p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>postgres -p 1234</code></strong>
</pre><p>
   要使用<span class="application">psql</span>连接到这个服务器，用 -p 选项指定这个端口：
</p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>psql -p 1234</code></strong>
</pre><p>
   或者设置环境变量<code class="envar">PGPORT</code>：
</p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>export PGPORT=1234</code></strong>
<code class="prompt">$</code> <strong class="userinput"><code>psql</code></strong>
</pre><p>
  </p><p>
   命名运行时参数可以用这些形式之一设置：
</p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>postgres -c work_mem=1234</code></strong>
<code class="prompt">$</code> <strong class="userinput"><code>postgres --work-mem=1234</code></strong>
</pre><p>
   两种形式都覆盖<code class="filename">postgresql.conf</code>中可能存在的<code class="varname">work_mem</code>设置。请注意在参数名中的下划线在命令行可以写成下划线或连字符。除了用于短期的实验外，更好的习惯是编辑<code class="filename">postgresql.conf</code>中的设置， 而不是倚赖命令行开关来设置参数。
  </p></div><div class="refsect1" id="id-1.9.5.14.13"><h2>参见</h2><p>
   <a class="xref" href="app-initdb.html" title="initdb"><span class="refentrytitle">initdb</span></a>,
   <a class="xref" href="app-pg-ctl.html" title="pg_ctl"><span class="refentrytitle"><span class="application">pg_ctl</span></span></a>
  </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="pgwaldump.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="reference-server.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="app-postmaster.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top"><span class="application">pg_waldump</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> <span class="application">postmaster</span></td></tr></table></div></body></html>