<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>32.1. 什么是JIT编译？</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="jit.html" title="第 32 章 即时编译（JIT）" /><link rel="next" href="jit-decision.html" title="32.2. 什么时候会用JIT？" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">32.1. 什么是<acronym xmlns="http://www.w3.org/1999/xhtml" class="acronym">JIT</acronym>编译？</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="jit.html" title="第 32 章 即时编译（JIT）">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="jit.html" title="第 32 章 即时编译（JIT）">上一级</a></td><th width="60%" align="center">第 32 章 即时编译（<acronym xmlns="http://www.w3.org/1999/xhtml" class="acronym">JIT</acronym>）</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 11.2 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="jit-decision.html" title="32.2. 什么时候会用JIT？">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="JIT-REASON"><div class="titlepage"><div><div><h2 class="title" style="clear: both">32.1. 什么是<acronym class="acronym">JIT</acronym>编译？</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="jit-reason.html#JIT-ACCELERATED-OPERATIONS">32.1.1. <acronym class="acronym">JIT</acronym>加速的操作</a></span></dt><dt><span class="sect2"><a href="jit-reason.html#JIT-INLINING">32.1.2. 内联</a></span></dt><dt><span class="sect2"><a href="jit-reason.html#JIT-OPTIMIZATION">32.1.3. 优化</a></span></dt></dl></div><p>
   即时（Just-In-Time，<acronym class="acronym">JIT</acronym>）编译是将某种形式的解释程序计算转变成原生程序的过程，并且这一过程是在运行时完成的。例如，与使用能够计算任意SQL表达式的通用代码来计算一个特定的SQL谓词（如<code class="literal">WHERE a.col = 3</code>）不同，可以产生一个专门针对该表达式的函数并且可以由CPU原生执行，从而得到加速。
  </p><p>
   当使用<a class="link" href="install-procedure.html#CONFIGURE-WITH-LLVM"><code class="literal">--with-llvm</code></a>编译<span class="productname">PostgreSQL</span>后，<span class="productname">PostgreSQL</span>内建支持用<a class="ulink" href="https://llvm.org/" target="_top"><span class="productname">LLVM</span></a>执行<acronym class="acronym">JIT</acronym>编译。
  </p><p>
   进一步的细节请参考<code class="filename">src/backend/jit/README</code>。
  </p><div class="sect2" id="JIT-ACCELERATED-OPERATIONS"><div class="titlepage"><div><div><h3 class="title">32.1.1. <acronym class="acronym">JIT</acronym>加速的操作</h3></div></div></div><p>
    当前，<span class="productname">PostgreSQL</span>的<acronym class="acronym">JIT</acronym>实现支持对表达式计算以及元组拆解的加速。未来可能有更多其他操作采用这种技术加速。
   </p><p>
    表达式计算被用来计算<code class="literal">WHERE</code>子句、目标列表、聚集以及投影。通过为每一种情况生成专门的代码来实现加速。
   </p><p>
    元组拆解是把一个磁盘上的元组（见<a class="xref" href="storage-page-layout.html#STORAGE-TUPLE-LAYOUT" title="68.6.1. 表行布局">第 68.6.1 节</a>）转换成其在内存中表示的过程。通过创建一个专门针对该表布局和要被抽取的列数的函数来实现加速。
   </p></div><div class="sect2" id="JIT-INLINING"><div class="titlepage"><div><div><h3 class="title">32.1.2. 内联</h3></div></div></div><p>
    <span class="productname">PostgreSQL</span>有很好的扩展性并且允许定义新的数据类型、函数、操作符以及其他数据库对象，见<a class="xref" href="extend.html" title="第 38 章 扩展 SQL">第 38 章</a>。实际上，内建对象都使用近乎完全相同的机制来实现。这种可扩展性隐含了一些开销，例如函数调用带来的开销（见<a class="xref" href="xfunc.html" title="38.3. 用户定义的函数">第 38.3 节</a>）。为了降低这类开销，<acronym class="acronym">JIT</acronym>编译可以把小函数的函数体内联到使用它们的表达式中。这种方式可以优化掉可观的开销。
   </p></div><div class="sect2" id="JIT-OPTIMIZATION"><div class="titlepage"><div><div><h3 class="title">32.1.3. 优化</h3></div></div></div><p>
    <span class="productname">LLVM</span>支持对生成的代码进行优化。一些优化代价很低，以至于可以在每次使用<acronym class="acronym">JIT</acronym>时都执行，而另一些优化则只有在运行时间较长的查询中才能获益。更多有关优化的细节请参考<a class="ulink" href="https://llvm.org/docs/Passes.html#transform-passes" target="_top">https://llvm.org/docs/Passes.html#transform-passes</a>。
   </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="jit.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="jit.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="jit-decision.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">第 32 章 即时编译（<acronym class="acronym">JIT</acronym>） </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 32.2. 什么时候会用<acronym class="acronym">JIT</acronym>？</td></tr></table></div></body></html>