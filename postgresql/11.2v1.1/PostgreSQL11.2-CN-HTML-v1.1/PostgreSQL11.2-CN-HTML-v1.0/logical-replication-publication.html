<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>31.1. 发布</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="logical-replication.html" title="第 31 章 逻辑复制" /><link rel="next" href="logical-replication-subscription.html" title="31.2. 订阅" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">31.1. 发布</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="logical-replication.html" title="第 31 章 逻辑复制">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="logical-replication.html" title="第 31 章 逻辑复制">上一级</a></td><th width="60%" align="center">第 31 章 逻辑复制</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 11.2 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="logical-replication-subscription.html" title="31.2. 订阅">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="LOGICAL-REPLICATION-PUBLICATION"><div class="titlepage"><div><div><h2 class="title" style="clear: both">31.1. 发布</h2></div></div></div><p>
   <em class="firstterm">发布</em>可以被定义在任何物理复制的主服务器上。定义有发布的节点被称为<em class="firstterm">发布者</em>。发布是从一个表或者一组表生成的改变的集合，也可以被描述为更改集合或者复制集合。每个发布都只存在于一个数据库中。
  </p><p>
   发布与模式不同，不会影响表的访问方式。如果需要，每个表都可以被加入到多个发布。当前，发布只能包含表。对象必须被明确地加入到发布，除非发布是用<code class="literal">ALL TABLES</code>创建的。
  </p><p>
   Publication可以选择把它们产生的更改限制为<code class="command">INSERT</code>、<code class="command">UPDATE</code>、<code class="command">DELETE</code>以及<code class="command">TRUNCATE</code>的任意组合，类似于触发器如何被特定事件类型触发的方式。默认情况下，所有操作类型都会被复制。
  </p><p>
   为了能够复制<code class="command">UPDATE</code>和<code class="command">DELETE</code>操作，被发布的表必须配置有一个<span class="quote">“<span class="quote">复制标识</span>”</span>，这样在订阅者那一端才能标识对于更新或删除合适的行。默认情况下，复制标识就是主键（如果有主键）。也可以在复制标识上设置另一个唯一索引（有特定的额外要求）。如果表没有合适的键，那么可以设置成复制标识<span class="quote">“<span class="quote">full</span>”</span>，它表示整个行都成为那个键。不过，这样做效率很低，只有在没有其他方案的情况下才应该使用。如果在发布者端设置了<span class="quote">“<span class="quote">full</span>”</span>之外的复制标识，在订阅者端也必须设置一个复制标识，它应该由相同的或者少一些的列组成。如何设置复制标识的细节请参考<a class="xref" href="sql-altertable.html#SQL-CREATETABLE-REPLICA-IDENTITY"><code class="literal">REPLICA IDENTITY</code></a>。如果在复制<code class="command">UPDATE</code>或<code class="command">DELETE</code>操作的发布中加入了没有复制标识的表，那么订阅者上后续的<code class="command">UPDATE</code>或<code class="command">DELETE</code>操作将导致错误。不管有没有复制标识，<code class="command">INSERT</code>操作都能继续下去。
  </p><p>
   每一个发布都可以由多个订阅者。
  </p><p>
   Publication通过使用<a class="xref" href="sql-createpublication.html" title="CREATE PUBLICATION"><span class="refentrytitle">CREATE PUBLICATION</span></a>命令创建并且可以在之后使用相应的命令进行修改或者删除。
  </p><p>
   表可以使用<a class="xref" href="sql-alterpublication.html" title="ALTER PUBLICATION"><span class="refentrytitle">ALTER PUBLICATION</span></a>动态地增加或者移除。<code class="literal">ADD TABLE</code>以及<code class="literal">DROP TABLE</code>操作都是事务性的，因此一旦该事务提交，该表将以正确的快照开始或者停止复制。
  </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="logical-replication.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="logical-replication.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="logical-replication-subscription.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">第 31 章 逻辑复制 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 31.2. 订阅</td></tr></table></div></body></html>