<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>8.2. 货币类型</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="datatype-numeric.html" title="8.1. 数字类型" /><link rel="next" href="datatype-character.html" title="8.3. 字符类型" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">8.2. 货币类型</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="datatype-numeric.html" title="8.1. 数字类型">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="datatype.html" title="第 8 章 数据类型">上一级</a></td><th width="60%" align="center">第 8 章 数据类型</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 11.2 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="datatype-character.html" title="8.3. 字符类型">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="DATATYPE-MONEY"><div class="titlepage"><div><div><h2 class="title" style="clear: both">8.2. 货币类型</h2></div></div></div><p>
    <code class="type">money</code>类型存储固定小数精度的货币数字，参阅<a class="xref" href="datatype-money.html#DATATYPE-MONEY-TABLE" title="表 8.3. 货币类型">表 8.3</a>。小数的精度由数据库的<a class="xref" href="runtime-config-client.html#GUC-LC-MONETARY">lc_monetary</a>设置决定。表中展示的范围假设有两个小数位。可接受的输入格式很多，包括整数和浮点数文字，以及常用的货币格式，如<code class="literal">'$1,000.00'</code>。 输出通常是最后一种形式，但和区域相关。
   </p><div class="table" id="DATATYPE-MONEY-TABLE"><p class="title"><strong>表 8.3. 货币类型</strong></p><div class="table-contents"><table class="table" summary="货币类型" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>名字</th><th>存储尺寸</th><th>描述</th><th>范围</th></tr></thead><tbody><tr><td><code class="type">money</code></td><td>8 bytes</td><td>货币额</td><td>-92233720368547758.08到+92233720368547758.07</td></tr></tbody></table></div></div><br class="table-break" /><p>
    由于这种数据类型的输出是区域敏感的，因此将<code class="type">money</code>数据装入到一个具有不同<code class="varname">lc_monetary</code>设置的数据库是不起作用的。为了避免这种问题，在恢复一个转储到一个新数据库中之前，应确保新数据库的<code class="varname">lc_monetary</code>设置和被转储数据库的相同或者具有等效值。
   </p><p>
    数据类型<code class="type">numeric</code>、<code class="type">int</code>和<code class="type">bigint</code>的值可以被造型成<code class="type">money</code>。从数据类型<code class="type">real</code>和<code class="type">double precision</code>的转换可以通过先造型成<code class="type">numeric</code>来实现，例如：
</p><pre class="programlisting">
SELECT '12.34'::float8::numeric::money;
</pre><p>
    但是，我们不推荐这样做。浮点数不应该被用来处理货币，因为浮点数可能会有圆整错误。
   </p><p>
    一个<code class="type">money</code>值可以在不损失精度的情况下被造型成<code class="type">numeric</code>。转换到其他类型可能会丢失精度，并且必须采用两个阶段完成：
</p><pre class="programlisting">
SELECT '52093.89'::money::numeric::float8;
</pre><p>
   </p><p>
    一个<code class="type">money</code>值被一个整数值除的除法结果会被截去分数部分。要得到圆整的结果，可以除以一个浮点值，或者在除法之前把<code class="type">money</code>转换成<code class="type">numeric</code>然后在除法之后转回<code class="type">money</code>（如果要避免精度丢失的风险则后者更好）。当一个<code class="type">money</code>值被另一个<code class="type">money</code>值除时，结果是<code class="type">double precision</code>（即一个纯数字，而不是金额），在除法中货币单位被约掉了。
   </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="datatype-numeric.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="datatype.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="datatype-character.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">8.1. 数字类型 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 8.3. 字符类型</td></tr></table></div></body></html>