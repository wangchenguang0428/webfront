<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>9.2. 比较函数和操作符</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="functions-logical.html" title="9.1. 逻辑操作符" /><link rel="next" href="functions-math.html" title="9.3. 数学函数和操作符" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">9.2. 比较函数和操作符</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="functions-logical.html" title="9.1. 逻辑操作符">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="functions.html" title="第 9 章 函数和操作符">上一级</a></td><th width="60%" align="center">第 9 章 函数和操作符</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 11.2 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="functions-math.html" title="9.3. 数学函数和操作符">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="FUNCTIONS-COMPARISON"><div class="titlepage"><div><div><h2 class="title" style="clear: both">9.2. 比较函数和操作符</h2></div></div></div><a id="id-1.5.8.7.2" class="indexterm"></a><p>
    常见的比较操作符都可用，如<a class="xref" href="functions-comparison.html#FUNCTIONS-COMPARISON-OP-TABLE" title="表 9.1. 比较操作符">表 9.1</a>所示。
   </p><div class="table" id="FUNCTIONS-COMPARISON-OP-TABLE"><p class="title"><strong>表 9.1. 比较操作符</strong></p><div class="table-contents"><table class="table" summary="比较操作符" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>操作符</th><th>描述</th></tr></thead><tbody><tr><td> <code class="literal">&lt;</code> </td><td>小于</td></tr><tr><td> <code class="literal">&gt;</code> </td><td>大于</td></tr><tr><td> <code class="literal">&lt;=</code> </td><td>小于等于</td></tr><tr><td> <code class="literal">&gt;=</code> </td><td>大于等于</td></tr><tr><td> <code class="literal">=</code> </td><td>等于</td></tr><tr><td> <code class="literal">&lt;&gt;</code> or <code class="literal">!=</code> </td><td>不等于</td></tr></tbody></table></div></div><br class="table-break" /><div class="note"><h3 class="title">注意</h3><p>
     <code class="literal">!=</code>操作符在分析器阶段被转换成<code class="literal">&lt;&gt;</code>。不能把<code class="literal">!=</code>和<code class="literal">&lt;&gt;</code>操作符实现为做不同的事。
    </p></div><p>
    比较操作符可以用于所有可以比较的数据类型。所有比较操作符都是双目操作符，它们返回<code class="type">boolean</code>类型；类似于<code class="literal">1 &lt; 2 &lt; 3</code>的表达式是非法的（因为没有<code class="literal">&lt;</code>操作符可以比较一个布尔值和<code class="literal">3</code>）。
   </p><p>
    如<a class="xref" href="functions-comparison.html#FUNCTIONS-COMPARISON-PRED-TABLE" title="表 9.2. 比较谓词">表 9.2</a>所示，也有一些比较谓词。它们的行为和操作符很像，但是具有 SQL 标准所要求的特殊语法。
   </p><div class="table" id="FUNCTIONS-COMPARISON-PRED-TABLE"><p class="title"><strong>表 9.2. 比较谓词</strong></p><div class="table-contents"><table class="table" summary="比较谓词" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>谓词</th><th>描述</th></tr></thead><tbody><tr><td> <em class="replaceable"><code>a</code></em> <code class="literal">BETWEEN</code> <em class="replaceable"><code>x</code></em> <code class="literal">AND</code> <em class="replaceable"><code>y</code></em> </td><td>在<em class="replaceable"><code>x</code></em>和<em class="replaceable"><code>y</code></em>之间</td></tr><tr><td> <em class="replaceable"><code>a</code></em> <code class="literal">NOT BETWEEN</code> <em class="replaceable"><code>x</code></em> <code class="literal">AND</code> <em class="replaceable"><code>y</code></em> </td><td>不在<em class="replaceable"><code>x</code></em>和<em class="replaceable"><code>y</code></em>之间</td></tr><tr><td> <em class="replaceable"><code>a</code></em> <code class="literal">BETWEEN SYMMETRIC</code> <em class="replaceable"><code>x</code></em> <code class="literal">AND</code> <em class="replaceable"><code>y</code></em> </td><td>在对比较值排序后位于<em class="replaceable"><code>x</code></em>和<em class="replaceable"><code>y</code></em>之间</td></tr><tr><td> <em class="replaceable"><code>a</code></em> <code class="literal">NOT BETWEEN SYMMETRIC</code> <em class="replaceable"><code>x</code></em> <code class="literal">AND</code> <em class="replaceable"><code>y</code></em> </td><td>在对比较值排序后不位于<em class="replaceable"><code>x</code></em>和<em class="replaceable"><code>y</code></em>之间</td></tr><tr><td> <em class="replaceable"><code>a</code></em> <code class="literal">IS DISTINCT FROM</code> <em class="replaceable"><code>b</code></em> </td><td>不等于，空值被当做一个普通值</td></tr><tr><td><em class="replaceable"><code>a</code></em> <code class="literal">IS NOT DISTINCT FROM</code> <em class="replaceable"><code>b</code></em></td><td>等于，空值被当做一个普通值</td></tr><tr><td> <em class="replaceable"><code>expression</code></em> <code class="literal">IS NULL</code> </td><td>是空值</td></tr><tr><td> <em class="replaceable"><code>expression</code></em> <code class="literal">IS NOT NULL</code> </td><td>不是空值</td></tr><tr><td> <em class="replaceable"><code>expression</code></em> <code class="literal">ISNULL</code> </td><td>是空值（非标准语法）</td></tr><tr><td> <em class="replaceable"><code>expression</code></em> <code class="literal">NOTNULL</code> </td><td>不是空值（非标准语法）</td></tr><tr><td> <em class="replaceable"><code>boolean_expression</code></em> <code class="literal">IS TRUE</code> </td><td>为真</td></tr><tr><td> <em class="replaceable"><code>boolean_expression</code></em> <code class="literal">IS NOT TRUE</code> </td><td>为假或未知</td></tr><tr><td> <em class="replaceable"><code>boolean_expression</code></em> <code class="literal">IS FALSE</code> </td><td>为假</td></tr><tr><td> <em class="replaceable"><code>boolean_expression</code></em> <code class="literal">IS NOT FALSE</code> </td><td>为真或者未知</td></tr><tr><td> <em class="replaceable"><code>boolean_expression</code></em> <code class="literal">IS UNKNOWN</code> </td><td>值为未知</td></tr><tr><td> <em class="replaceable"><code>boolean_expression</code></em> <code class="literal">IS NOT UNKNOWN</code> </td><td>为真或者为假</td></tr></tbody></table></div></div><br class="table-break" /><p>
    <a id="id-1.5.8.7.9.1" class="indexterm"></a>
    <code class="token">BETWEEN</code>谓词可以简化范围测试：
</p><pre class="synopsis">
<em class="replaceable"><code>a</code></em> BETWEEN <em class="replaceable"><code>x</code></em> AND <em class="replaceable"><code>y</code></em>
</pre><p>
    等效于
</p><pre class="synopsis">
<em class="replaceable"><code>a</code></em> &gt;= <em class="replaceable"><code>x</code></em> AND <em class="replaceable"><code>a</code></em> &lt;= <em class="replaceable"><code>y</code></em>
</pre><p>
    注意<code class="token">BETWEEN</code>认为终点值是包含在范围内的。
    <code class="literal">NOT BETWEEN</code>可以做相反比较：
</p><pre class="synopsis">
<em class="replaceable"><code>a</code></em> NOT BETWEEN <em class="replaceable"><code>x</code></em> AND <em class="replaceable"><code>y</code></em>
</pre><p>
    等效于
</p><pre class="synopsis">
<em class="replaceable"><code>a</code></em> &lt; <em class="replaceable"><code>x</code></em> OR <em class="replaceable"><code>a</code></em> &gt; <em class="replaceable"><code>y</code></em>
</pre><p>
    <a id="id-1.5.8.7.9.9" class="indexterm"></a>
    <code class="literal">BETWEEN SYMMETRIC</code>和<code class="literal">BETWEEN</code>相似，不过<code class="literal">BETWEEN SYMMETRIC</code>不要求<code class="literal">AND</code>左边的参数小于或等于右边的参数。如果左参数不是小于等于右参数，这两个参数会自动被交换，这样总是会应用一个非空范围。
   </p><p>
    <a id="id-1.5.8.7.10.1" class="indexterm"></a>
    <a id="id-1.5.8.7.10.2" class="indexterm"></a>
    当有一个输入为空时，普通的比较操作符会得到空（表示<span class="quote">“<span class="quote">未知</span>”</span>），而不是真或假。例如，<code class="literal">7 = NULL</code>得到空，<code class="literal">7 &lt;&gt; NULL</code>也一样。如果这种行为不合适，可以使用<code class="literal">IS [<span class="optional"> NOT </span>] DISTINCT FROM</code>谓词：
</p><pre class="synopsis">
<em class="replaceable"><code>a</code></em> IS DISTINCT FROM <em class="replaceable"><code>b</code></em>
<em class="replaceable"><code>a</code></em> IS NOT DISTINCT FROM <em class="replaceable"><code>b</code></em>
</pre><p>
    对于非空输入，<code class="literal">IS DISTINCT FROM</code>和<code class="literal">&lt;&gt;</code>操作符一样。不过，如果两个输入都为空，它会返回假。而如果只有一个输入为空，它会返回真。类似地，<code class="literal">IS NOT DISTINCT FROM</code>对于非空输入的行为与<code class="literal">=</code>相同，但是当两个输入都为空时它返回真，并且当只有一个输入为空时返回假。因此，这些谓词实际上把空值当作一种普通数据值而不是<span class="quote">“<span class="quote">unknown</span>”</span>。
   </p><p>
    <a id="id-1.5.8.7.11.1" class="indexterm"></a>
    <a id="id-1.5.8.7.11.2" class="indexterm"></a>
    <a id="id-1.5.8.7.11.3" class="indexterm"></a>
    <a id="id-1.5.8.7.11.4" class="indexterm"></a>
    要检查一个值是否为空，使用下面的谓词：
</p><pre class="synopsis">
<em class="replaceable"><code>expression</code></em> IS NULL
<em class="replaceable"><code>expression</code></em> IS NOT NULL
</pre><p>
    或者等效，但并不标准的谓词：
</p><pre class="synopsis">
<em class="replaceable"><code>expression</code></em> ISNULL
<em class="replaceable"><code>expression</code></em> NOTNULL
</pre><p>
    <a id="id-1.5.8.7.11.7" class="indexterm"></a>
   </p><p>
    <span class="emphasis"><em>不要</em></span>写<code class="literal"><em class="replaceable"><code>expression</code></em> = NULL</code>，因为<code class="literal">NULL</code>是不<span class="quote">“<span class="quote">等于</span>”</span><code class="literal">NULL</code>的（控制代表一个未知的值，因此我们无法知道两个未知的数值是否相等）。
   </p><div class="tip"><h3 class="title">提示</h3><p>
    有些应用可能要求表达式<code class="literal"><em class="replaceable"><code>expression</code></em> = NULL</code>在<em class="replaceable"><code>expression</code></em>得出空值时返回真。我们强烈建议这样的应用修改成遵循 SQL 标准。但是，如果这样修改不可能完成，那么我们可以使用配置变量<a class="xref" href="runtime-config-compatible.html#GUC-TRANSFORM-NULL-EQUALS">transform_null_equals</a>。如果打开它，<span class="productname">PostgreSQL</span>将把<code class="literal">x = NULL</code>子句转换成<code class="literal">x IS NULL</code>。
   </p></div><p>
    如果<em class="replaceable"><code>expression</code></em>是行值，那么当行表达式本身为非空值或者行的所有域为非空时<code class="literal">IS NULL</code>为真。由于这种行为，<code class="literal">IS NULL</code>和<code class="literal">IS NOT NULL</code>并不总是为行值表达式返回反转的结果，特别是，一个同时包含 NULL 和非空值的域将会对两种测试都返回假。在某些情况下，写成<em class="replaceable"><code>row</code></em> <code class="literal">IS DISTINCT FROM NULL</code>或者<em class="replaceable"><code>row</code></em> <code class="literal">IS NOT DISTINCT FROM NULL</code>会更好，它们只会检查整个行值是否为空而不需要在行的域上做额外的测试。
   </p><p>
    <a id="id-1.5.8.7.15.1" class="indexterm"></a>
    <a id="id-1.5.8.7.15.2" class="indexterm"></a>
    <a id="id-1.5.8.7.15.3" class="indexterm"></a>
    <a id="id-1.5.8.7.15.4" class="indexterm"></a>
    <a id="id-1.5.8.7.15.5" class="indexterm"></a>
    <a id="id-1.5.8.7.15.6" class="indexterm"></a>
    布尔值也可以使用下列谓词进行测试：
</p><pre class="synopsis">
<em class="replaceable"><code>boolean_expression</code></em> IS TRUE
<em class="replaceable"><code>boolean_expression</code></em> IS NOT TRUE
<em class="replaceable"><code>boolean_expression</code></em> IS FALSE
<em class="replaceable"><code>boolean_expression</code></em> IS NOT FALSE
<em class="replaceable"><code>boolean_expression</code></em> IS UNKNOWN
<em class="replaceable"><code>boolean_expression</code></em> IS NOT UNKNOWN
</pre><p>
    这些谓词将总是返回真或假，从来不返回空值，即使操作数是空也如此。空值输入被当做逻辑值<span class="quote">“<span class="quote">未知</span>”</span>。 请注意实际上<code class="literal">IS UNKNOWN</code>和<code class="literal">IS NOT UNKNOWN</code>分别与<code class="literal">IS NULL</code>和<code class="literal">IS NOT NULL</code>相同， 只是输入表达式必须是布尔类型。
   </p><p>
    如<a class="xref" href="functions-comparison.html#FUNCTIONS-COMPARISON-FUNC-TABLE" title="表 9.3. 比较函数">表 9.3</a>中所示，也有一些比较相关的函数可用。
   </p><div class="table" id="FUNCTIONS-COMPARISON-FUNC-TABLE"><p class="title"><strong>表 9.3. 比较函数</strong></p><div class="table-contents"><table class="table" summary="比较函数" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>函数</th><th>描述</th><th>例子</th><th>例子结果</th></tr></thead><tbody><tr><td>
         <a id="id-1.5.8.7.17.2.2.1.1.1" class="indexterm"></a>
         <code class="literal">num_nonnulls(VARIADIC "any")</code>
       </td><td>返回非空参数的数量</td><td><code class="literal">num_nonnulls(1, NULL, 2)</code></td><td><code class="literal">2</code></td></tr><tr><td>
         <a id="id-1.5.8.7.17.2.2.2.1.1" class="indexterm"></a>
         <code class="literal">num_nulls(VARIADIC "any")</code>
       </td><td>返回空参数的数量</td><td><code class="literal">num_nulls(1, NULL, 2)</code></td><td><code class="literal">1</code></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="functions-logical.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="functions.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="functions-math.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">9.1. 逻辑操作符 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 9.3. 数学函数和操作符</td></tr></table></div></body></html>