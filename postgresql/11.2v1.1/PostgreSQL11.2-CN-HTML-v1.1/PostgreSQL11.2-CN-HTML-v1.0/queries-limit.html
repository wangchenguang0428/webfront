<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>7.6. LIMIT和OFFSET</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="queries-order.html" title="7.5. 行排序" /><link rel="next" href="queries-values.html" title="7.7. VALUES列表" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">7.6. <code xmlns="http://www.w3.org/1999/xhtml" class="literal">LIMIT</code>和<code xmlns="http://www.w3.org/1999/xhtml" class="literal">OFFSET</code></th></tr><tr><td width="10%" align="left"><a accesskey="p" href="queries-order.html" title="7.5. 行排序">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="queries.html" title="第 7 章 查询">上一级</a></td><th width="60%" align="center">第 7 章 查询</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 11.2 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="queries-values.html" title="7.7. VALUES列表">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="QUERIES-LIMIT"><div class="titlepage"><div><div><h2 class="title" style="clear: both">7.6. <code class="literal">LIMIT</code>和<code class="literal">OFFSET</code></h2></div></div></div><a id="id-1.5.6.10.2" class="indexterm"></a><a id="id-1.5.6.10.3" class="indexterm"></a><p>
   <code class="literal">LIMIT</code>和<code class="literal">OFFSET</code>允许你只检索查询剩余部分产生的行的一部分：
</p><pre class="synopsis">
SELECT <em class="replaceable"><code>select_list</code></em>
    FROM <em class="replaceable"><code>table_expression</code></em>
    [<span class="optional"> ORDER BY ... </span>]
    [<span class="optional"> LIMIT { <em class="replaceable"><code>number</code></em> | ALL } </span>] [<span class="optional"> OFFSET <em class="replaceable"><code>number</code></em> </span>]
</pre><p>
  </p><p>
   如果给出了一个限制计数，那么会返回数量不超过该限制的行（但可能更少些，因为查询本身可能生成的行数就比较少）。<code class="literal">LIMIT ALL</code>的效果和省略<code class="literal">LIMIT</code>子句一样，就像是<code class="literal">LIMIT</code>带有 NULL 参数一样。
  </p><p>
   <code class="literal">OFFSET</code>说明在开始返回行之前忽略多少行。<code class="literal">OFFSET 0</code>的效果和省略<code class="literal">OFFSET</code>子句是一样的，并且<code class="literal">LIMIT NULL</code>的效果和省略<code class="literal">LIMIT</code>子句一样，就像是<code class="literal">OFFSET</code>带有 NULL 参数一样。
  </p><p>
   如果<code class="literal">OFFSET</code>和<code class="literal">LIMIT</code>都出现了， 那么在返回<code class="literal">LIMIT</code>个行之前要先忽略<code class="literal">OFFSET</code>行。
  </p><p>
   如果使用<code class="literal">LIMIT</code>，那么用一个<code class="literal">ORDER BY</code>子句把结果行约束成一个唯一的顺序是很重要的。否则你就会拿到一个不可预料的该查询的行的子集。你要的可能是第十到第二十行，但以什么顺序的第十到第二十？除非你指定了<code class="literal">ORDER BY</code>，否则顺序是不知道的。
  </p><p>
   查询优化器在生成查询计划时会考虑<code class="literal">LIMIT</code>，因此如果你给定<code class="literal">LIMIT</code>和<code class="literal">OFFSET</code>，那么你很可能收到不同的规划（产生不同的行顺序）。因此，使用不同的<code class="literal">LIMIT</code>/<code class="literal">OFFSET</code>值选择查询结果的不同子集<span class="emphasis"><em>将生成不一致的结果</em></span>，除非你用<code class="literal">ORDER BY</code>强制一个可预测的顺序。这并非bug， 这是一个很自然的结果，因为 SQL 没有许诺把查询的结果按照任何特定的顺序发出，除非用了<code class="literal">ORDER BY</code>来约束顺序。
  </p><p>
   被<code class="literal">OFFSET</code>子句忽略的行仍然需要在服务器内部计算；因此，一个很大的<code class="literal">OFFSET</code>的效率可能还是不够高。
  </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="queries-order.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="queries.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="queries-values.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">7.5. 行排序 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 7.7. <code class="literal">VALUES</code>列表</td></tr></table></div></body></html>