<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>8.9. 网络地址类型</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="datatype-geometric.html" title="8.8. 几何类型" /><link rel="next" href="datatype-bit.html" title="8.10. 位串类型" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">8.9. 网络地址类型</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="datatype-geometric.html" title="8.8. 几何类型">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="datatype.html" title="第 8 章 数据类型">上一级</a></td><th width="60%" align="center">第 8 章 数据类型</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 11.2 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="datatype-bit.html" title="8.10. 位串类型">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="DATATYPE-NET-TYPES"><div class="titlepage"><div><div><h2 class="title" style="clear: both">8.9. 网络地址类型</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="datatype-net-types.html#DATATYPE-INET">8.9.1. <code class="type">inet</code></a></span></dt><dt><span class="sect2"><a href="datatype-net-types.html#DATATYPE-CIDR">8.9.2. <code class="type">cidr</code></a></span></dt><dt><span class="sect2"><a href="datatype-net-types.html#DATATYPE-INET-VS-CIDR">8.9.3. <code class="type">inet</code> vs. <code class="type">cidr</code></a></span></dt><dt><span class="sect2"><a href="datatype-net-types.html#DATATYPE-MACADDR">8.9.4. <code class="type">macaddr</code></a></span></dt><dt><span class="sect2"><a href="datatype-net-types.html#DATATYPE-MACADDR8">8.9.5. <code class="type">macaddr8</code></a></span></dt></dl></div><a id="id-1.5.7.17.2" class="indexterm"></a><p>
    <span class="productname">PostgreSQL</span>提供用于存储 IPv4、IPv6 和 MAC 地址的数据类型，如<a class="xref" href="datatype-net-types.html#DATATYPE-NET-TYPES-TABLE" title="表 8.21. 网络地址类型">表 8.21</a>所示。 用这些数据类型存储网络地址比用纯文本类型好，因为这些类型提供输入错误检查以及特殊的操作符和函数（见<a class="xref" href="functions-net.html" title="9.12. 网络地址函数和操作符">第 9.12 节</a>）
   </p><div class="table" id="DATATYPE-NET-TYPES-TABLE"><p class="title"><strong>表 8.21. 网络地址类型</strong></p><div class="table-contents"><table class="table" summary="网络地址类型" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>名字</th><th>存储尺寸</th><th>描述</th></tr></thead><tbody><tr><td><code class="type">cidr</code></td><td>7或19字节</td><td>IPv4和IPv6网络</td></tr><tr><td><code class="type">inet</code></td><td>7或19字节</td><td>IPv4和IPv6主机以及网络</td></tr><tr><td><code class="type">macaddr</code></td><td>6字节</td><td>MAC地址</td></tr><tr><td><code class="type">macaddr8</code></td><td>8 bytes</td><td>MAC地址（EUI-64格式）</td></tr></tbody></table></div></div><br class="table-break" /><p>
    在对<code class="type">inet</code>或者<code class="type">cidr</code>数据类型进行排序的时候， IPv4 地址将总是排在 IPv6 地址前面，包括那些封装或者是映射在 IPv6 地址里 的 IPv4 地址，例如 ::10.2.3.4 或者 ::ffff::10.4.3.2。
   </p><div class="sect2" id="DATATYPE-INET"><div class="titlepage"><div><div><h3 class="title">8.9.1. <code class="type">inet</code></h3></div></div></div><a id="id-1.5.7.17.6.2" class="indexterm"></a><p>
     <code class="type">inet</code>在一个数据域里保存一个 IPv4 或 IPv6 主机地址，以及一个可选的它的子网。 子网由主机地址中表示的网络地址位数表示（<span class="quote">“<span class="quote">网络掩码</span>”</span>）。 如果网络掩码为 32 并且地址是 IPv4 ，那么该值不表示任何子网，只是一台主机。在 IPv6 中地址长度是 128 位，因此 128 位指定一个唯一的主机地址。 请注意如果你想只接受网络地址，你应该使用<code class="type">cidr</code>类型而不是<code class="type">inet</code>。
    </p><p>
      该类型的输入格式是<em class="replaceable"><code>地址/y</code></em>，其中<em class="replaceable"><code>地址</code></em>是一个 IPv4 或者 IPv6 地址，<em class="replaceable"><code>y</code></em>是网络掩码的位数。如果<em class="replaceable"><code>/y</code></em>部分缺失， 则网络掩码对 IPv4 而言是 32，对 IPv6 而言是 128，所以该值表示只有一台主机。在显示时，如果<em class="replaceable"><code>/y</code></em>部分指定一个单台主机，它将不会被显示出来。
    </p></div><div class="sect2" id="DATATYPE-CIDR"><div class="titlepage"><div><div><h3 class="title">8.9.2. <code class="type">cidr</code></h3></div></div></div><a id="id-1.5.7.17.7.2" class="indexterm"></a><p>
     <code class="type">cidr</code>类型保存一个 IPv4 或 IPv6 网络地址声明。其输入和输出遵循无类的互联网域路由（Classless Internet Domain Routing）习惯。声明一个网络的格式是<em class="replaceable"><code>地址/y</code></em>，其中<em class="replaceable"><code>address</code></em>是 IPv4 或 IPv6 网络地址而<em class="replaceable"><code>y</code></em>是网络掩码的位数。如果省略<em class="replaceable"><code>y</code></em>， 那么掩码部分用旧的有类的网络编号系统进行计算，否则它将至少大到足以包括写在输入中的所有字节。声明一个在其指定的掩码右边置了位的网络地址会导致错误。
    </p><p>
     <a class="xref" href="datatype-net-types.html#DATATYPE-NET-CIDR-TABLE" title="表 8.22. cidr类型输入例子">表 8.22</a>展示了一些例子。
    </p><div class="table" id="DATATYPE-NET-CIDR-TABLE"><p class="title"><strong>表 8.22. <code class="type">cidr</code>类型输入例子</strong></p><div class="table-contents"><table class="table" summary="cidr类型输入例子" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th><code class="type">cidr</code>输入</th><th><code class="type">cidr</code>输出</th><th><code class="literal"><code class="function">abbrev(<code class="type">cidr</code>)</code></code></th></tr></thead><tbody><tr><td>192.168.100.128/25</td><td>192.168.100.128/25</td><td>192.168.100.128/25</td></tr><tr><td>192.168/24</td><td>192.168.0.0/24</td><td>192.168.0/24</td></tr><tr><td>192.168/25</td><td>192.168.0.0/25</td><td>192.168.0.0/25</td></tr><tr><td>192.168.1</td><td>192.168.1.0/24</td><td>192.168.1/24</td></tr><tr><td>192.168</td><td>192.168.0.0/24</td><td>192.168.0/24</td></tr><tr><td>128.1</td><td>128.1.0.0/16</td><td>128.1/16</td></tr><tr><td>128</td><td>128.0.0.0/16</td><td>128.0/16</td></tr><tr><td>128.1.2</td><td>128.1.2.0/24</td><td>128.1.2/24</td></tr><tr><td>10.1.2</td><td>10.1.2.0/24</td><td>10.1.2/24</td></tr><tr><td>10.1</td><td>10.1.0.0/16</td><td>10.1/16</td></tr><tr><td>10</td><td>10.0.0.0/8</td><td>10/8</td></tr><tr><td>10.1.2.3/32</td><td>10.1.2.3/32</td><td>10.1.2.3/32</td></tr><tr><td>2001:4f8:3:ba::/64</td><td>2001:4f8:3:ba::/64</td><td>2001:4f8:3:ba::/64</td></tr><tr><td>2001:4f8:3:ba:2e0:81ff:fe22:d1f1/128</td><td>2001:4f8:3:ba:2e0:81ff:fe22:d1f1/128</td><td>2001:4f8:3:ba:2e0:81ff:fe22:d1f1</td></tr><tr><td>::ffff:1.2.3.0/120</td><td>::ffff:1.2.3.0/120</td><td>::ffff:1.2.3/120</td></tr><tr><td>::ffff:1.2.3.0/128</td><td>::ffff:1.2.3.0/128</td><td>::ffff:1.2.3.0/128</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2" id="DATATYPE-INET-VS-CIDR"><div class="titlepage"><div><div><h3 class="title">8.9.3. <code class="type">inet</code> vs. <code class="type">cidr</code></h3></div></div></div><p>
    <code class="type">inet</code>和<code class="type">cidr</code>类型之间的本质区别是<code class="type">inet</code>接受右边有非零位的网络掩码， 而<code class="type">cidr</code>不接受。例如，<code class="literal">192.168.0.1/24</code>对<code class="type">inet</code>是有效的，但对<code class="type">cidr</code>是无效的。
    </p><div class="tip"><h3 class="title">提示</h3><p>
        如果你不喜欢<code class="type">inet</code>或<code class="type">cidr</code>值的输出格式，可以尝试函数<code class="function">host</code>、<code class="function">text</code>和<code class="function">abbrev</code>。
        </p></div></div><div class="sect2" id="DATATYPE-MACADDR"><div class="titlepage"><div><div><h3 class="title">8.9.4. <code class="type">macaddr</code></h3></div></div></div><a id="id-1.5.7.17.9.2" class="indexterm"></a><a id="id-1.5.7.17.9.3" class="indexterm"></a><p>
     <code class="type">macaddr</code>类型存储 MAC 地址，也就是以太网卡硬件地址 （尽管 MAC 地址还用于其它用途）。可以接受下列格式的输入：

     </p><table border="0" summary="Simple list" class="simplelist"><tr><td><code class="literal">'08:00:2b:01:02:03'</code></td></tr><tr><td><code class="literal">'08-00-2b-01-02-03'</code></td></tr><tr><td><code class="literal">'08002b:010203'</code></td></tr><tr><td><code class="literal">'08002b-010203'</code></td></tr><tr><td><code class="literal">'0800.2b01.0203'</code></td></tr><tr><td><code class="literal">'0800-2b01-0203'</code></td></tr><tr><td><code class="literal">'08002b010203'</code></td></tr></table><p>

     这些例子指定的都是同一个地址。对于位<code class="literal">a</code>到<code class="literal">f</code>，大小写都可以接受。输出总是使用展示的第一种形式。    </p><p>
     IEEE Std 802-2001 指定第二种展示的形式（带有连字符）作为MAC地址的标准形式，并且指定第一种形式（带有分号）作为位翻转的记号，因此 08-00-2b-01-02-03 = 01:00:4D:08:04:0C。这种习惯目前已经被广泛地忽略，并且它只与废弃的网络协议（如令牌环）相关。PostgreSQL 没有对位翻转做任何规定，并且所有可接受的格式都使用标准的LSB顺序。
    </p><p>
     剩下的五种输入格式不属于任何标准。
    </p></div><div class="sect2" id="DATATYPE-MACADDR8"><div class="titlepage"><div><div><h3 class="title">8.9.5. <code class="type">macaddr8</code></h3></div></div></div><a id="id-1.5.7.17.10.2" class="indexterm"></a><a id="id-1.5.7.17.10.3" class="indexterm"></a><p>
     <code class="type">macaddr8</code>类型以EUI-64格式存储MAC地址，例如以太网卡的硬件地址（尽管MAC地址也被用于其他目的）。这种类型可以接受6字节和8字节长度的MAC地址，并且将它们存储为8字节长度的格式。以6字节格式给出的MAC地址被存储为8字节长度格式的方式是吧第4和第5字节分别设置为FF和FE。

     注意IPv6使用一种修改过的EUI-64格式，其中从EUI-48转换过来后的第7位应该被设置为一。函数<code class="function">macaddr8_set7bit</code>被用来做这种修改。

     一般而言，任何由16进制数（字节边界上）对构成的输入（可以由<code class="literal">':'</code>、<code class="literal">'-'</code>或者<code class="literal">'.'</code>统一地分隔）都会被接受。16进制数的数量必须是16（8字节）或者12（6字节）。前导和拖尾的空格会被忽略。

     下面是可以被接受的输入格式的例子：

     </p><table border="0" summary="Simple list" class="simplelist"><tr><td><code class="literal">'08:00:2b:01:02:03:04:05'</code></td></tr><tr><td><code class="literal">'08-00-2b-01-02-03-04-05'</code></td></tr><tr><td><code class="literal">'08002b:0102030405'</code></td></tr><tr><td><code class="literal">'08002b-0102030405'</code></td></tr><tr><td><code class="literal">'0800.2b01.0203.0405'</code></td></tr><tr><td><code class="literal">'0800-2b01-0203-0405'</code></td></tr><tr><td><code class="literal">'08002b01:02030405'</code></td></tr><tr><td><code class="literal">'08002b0102030405'</code></td></tr></table><p>

     这些例子都指定相同的地址。数字<code class="literal">a</code>到<code class="literal">f</code>的大小写形式都被接受。输出总是以上面显示的第一种形式。

     上述的后六种输入格式不属于任何标准。

     要把EUI-48格式的传统48位MAC地址转换成修改版EUI-64格式（包括在IPv6地址中作为主机部分），可以使用下面的<code class="function">macaddr8_set7bit</code>：

</p><pre class="programlisting">
SELECT macaddr8_set7bit('08:00:2b:01:02:03');
<code class="computeroutput">
    macaddr8_set7bit     
-------------------------
 0a:00:2b:ff:fe:01:02:03
(1 row)
</code>
</pre><p>

    </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="datatype-geometric.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="datatype.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="datatype-bit.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">8.8. 几何类型 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 8.10. 位串类型</td></tr></table></div></body></html>