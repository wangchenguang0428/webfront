<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>pg_isready</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="app-pg-dumpall.html" title="pg_dumpall" /><link rel="next" href="app-pgreceivewal.html" title="pg_receivewal" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center"><span xmlns="http://www.w3.org/1999/xhtml" class="application">pg_isready</span></th></tr><tr><td width="10%" align="left"><a accesskey="p" href="app-pg-dumpall.html" title="pg_dumpall">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="reference-client.html" title="PostgreSQL 客户端应用">上一级</a></td><th width="60%" align="center">PostgreSQL 客户端应用</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 11.2 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="app-pgreceivewal.html" title="pg_receivewal">下一页</a></td></tr></table><hr></hr></div><div class="refentry" id="APP-PG-ISREADY"><div class="titlepage"></div><a id="id-1.9.4.14.1" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle"><span class="application">pg_isready</span></span></h2><p>pg_isready — 检查一个<span class="productname">PostgreSQL</span>服务器的连接状态</p></div><div class="refsynopsisdiv"><h2>大纲</h2><div class="cmdsynopsis"><p id="id-1.9.4.14.4.1"><code class="command">pg_isready</code> [<em class="replaceable"><code>connection-option</code></em>...] [<em class="replaceable"><code>option</code></em>...]</p></div></div><div class="refsect1" id="APP-PG-ISREADY-DESCRIPTION"><h2>描述</h2><p>
   <span class="application">pg_isready</span>是一个用来检查一个<span class="productname">PostgreSQL</span>数据库服务器的连接状态的工具。其退出状态指定了连接检查的结果。
  </p></div><div class="refsect1" id="APP-PG-ISREADY-OPTIONS"><h2>选项</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-d <em class="replaceable"><code>dbname</code></em></code><br /></span><span class="term"><code class="option">--dbname=<em class="replaceable"><code>dbname</code></em></code></span></dt><dd><p>
       指定要连接的数据库名。
      </p><p>
       如果这个参数包含一个<code class="symbol">=</code>记号或者以一个合法的<acronym class="acronym">URI</acronym>前缀（<code class="literal">postgresql://</code>或<code class="literal">postgres://</code>）开始，它会被当作一个<em class="parameter"><code>conninfo</code></em>字符串。详见<a class="xref" href="libpq-connect.html#LIBPQ-CONNSTRING" title="34.1.1. 连接字符串">第 34.1.1 节</a>。
      </p></dd><dt><span class="term"><code class="option">-h <em class="replaceable"><code>hostname</code></em></code><br /></span><span class="term"><code class="option">--host=<em class="replaceable"><code>hostname</code></em></code></span></dt><dd><p>
       指定运行服务器的机器的主机名。如果该值以一个斜线开始，它被用作 Unix 域套接字的目录。
       </p></dd><dt><span class="term"><code class="option">-p <em class="replaceable"><code>port</code></em></code><br /></span><span class="term"><code class="option">--port=<em class="replaceable"><code>port</code></em></code></span></dt><dd><p>
       指定服务器正在监听连接的 TCP 端口或本地 Unix 域套接字文件扩展。默认值取自<code class="envar">PGPORT</code>环境变量。如果环境变量没有设置，则默认值使用编译时指定的端口（通常是 5432）。
       </p></dd><dt><span class="term"><code class="option">-q</code><br /></span><span class="term"><code class="option">--quiet</code></span></dt><dd><p>
        不显示状态消息。当脚本编程时有用。
       </p></dd><dt><span class="term"><code class="option">-t <em class="replaceable"><code>seconds</code></em></code><br /></span><span class="term"><code class="option">--timeout=<em class="replaceable"><code>seconds</code></em></code></span></dt><dd><p>
        尝试连接时，在返回服务器不响应之前等待的最大秒数。设置为 0 则禁用。默认值是 3 秒。
       </p></dd><dt><span class="term"><code class="option">-U <em class="replaceable"><code>username</code></em></code><br /></span><span class="term"><code class="option">--username=<em class="replaceable"><code>username</code></em></code></span></dt><dd><p>
       作为用户<em class="replaceable"><code>username</code></em>连接数据库，而不是用默认用户。
       </p></dd><dt><span class="term"><code class="option">-V</code><br /></span><span class="term"><code class="option">--version</code></span></dt><dd><p>
         打印<span class="application">pg_isready</span>版本并退出。
        </p></dd><dt><span class="term"><code class="option">-?</code><br /></span><span class="term"><code class="option">--help</code></span></dt><dd><p>
        显示有关<span class="application">pg_isready</span>命令行参数的帮助并退出。
       </p></dd></dl></div></div><div class="refsect1" id="id-1.9.4.14.7"><h2>退出状态</h2><p>
   如果服务器正常接受连接，<span class="application">pg_isready</span>返回<code class="literal">0</code>给 shell；如果服务器拒绝连接（例如处于启动阶段）则返回<code class="literal">1</code>；如果连接尝试没有被相应则返回<code class="literal">2</code>；如果没有尝试（例如由于非法参数）则返回<code class="literal">3</code>。
  </p></div><div class="refsect1" id="id-1.9.4.14.8"><h2>环境</h2><p>
   和大部分其他<span class="productname">PostgreSQL</span>工具相似，<code class="command">pg_isready</code>也使用<span class="application">libpq</span>（见<a class="xref" href="libpq-envars.html" title="34.14. 环境变量">第 34.14 节</a>）支持的环境变量。
  </p></div><div class="refsect1" id="APP-PG-ISREADY-NOTES"><h2>注解</h2><p>
   要获得服务器状态，不一定需要提供正确的用户名、口令或数据库名。
   不过，如果提供了不正确的值，服务器将会记录一次失败的连接尝试。
  </p></div><div class="refsect1" id="APP-PG-ISREADY-EXAMPLES"><h2>例子</h2><p>
   标准用法：
</p><pre class="screen">
<code class="prompt">$</code> <strong class="userinput"><code>pg_isready</code></strong>
<code class="computeroutput">/tmp:5432 - accepting connections</code>
<code class="prompt">$</code> <strong class="userinput"><code>echo $?</code></strong>
<code class="computeroutput">0</code>
</pre><p>
  </p><p>
   使用连接参数运行连接到处于启动中的<span class="productname">PostgreSQL</span>集簇：
</p><pre class="screen">
<code class="prompt">$ </code><strong class="userinput"><code>pg_isready -h localhost -p 5433</code></strong>
<code class="computeroutput">localhost:5433 - rejecting connections</code>
<code class="prompt">$</code> <strong class="userinput"><code>echo $?</code></strong>
<code class="computeroutput">1</code>
</pre><p>
  </p><p>
   使用连接参数运行连接到无响应的<span class="productname">PostgreSQL</span>集簇：
</p><pre class="screen">
<code class="prompt">$ </code><strong class="userinput"><code>pg_isready -h someremotehost</code></strong>
<code class="computeroutput">someremotehost:5432 - no response</code>
<code class="prompt">$</code> <strong class="userinput"><code>echo $?</code></strong>
<code class="computeroutput">2</code>
</pre><p>
  </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="app-pg-dumpall.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="reference-client.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="app-pgreceivewal.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top"><span class="application">pg_dumpall</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> pg_receivewal</td></tr></table></div></body></html>