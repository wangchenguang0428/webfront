<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>51.50. pg_statistic</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="catalog-pg-shseclabel.html" title="51.49. pg_shseclabel" /><link rel="next" href="catalog-pg-statistic-ext.html" title="51.51. pg_statistic_ext" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">51.50. <code xmlns="http://www.w3.org/1999/xhtml" class="structname">pg_statistic</code></th></tr><tr><td width="10%" align="left"><a accesskey="p" href="catalog-pg-shseclabel.html" title="51.49. pg_shseclabel">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="catalogs.html" title="第 51 章 系统目录">上一级</a></td><th width="60%" align="center">第 51 章 系统目录</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 12.2 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="catalog-pg-statistic-ext.html" title="51.51. pg_statistic_ext">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="CATALOG-PG-STATISTIC"><div class="titlepage"><div><div><h2 class="title" style="clear: both">51.50. <code class="structname">pg_statistic</code></h2></div></div></div><a id="id-1.10.4.52.2" class="indexterm"></a><p>
   目录<code class="structname">pg_statistic</code>存储有关数据库内容的统计数据。其中的项由<a class="xref" href="sql-analyze.html" title="ANALYZE"><span class="refentrytitle">ANALYZE</span></a>创建，查询规划器会使用这些数据来进行查询规划。注意所有的统计数据天然就是近似的，即使它刚刚被更新。
  </p><p>
   通常对于数据表中一个已经被 ANALYZE 过的列，在本目录中会存在一个<code class="structfield">stainherit</code> = <code class="literal">false</code>的项。如果该列所在的表具有后代（即有其他表继承该表），对于该列还会创建第二个<code class="structfield">stainherit</code> = <code class="literal">true</code>的项。<code class="structfield">stainherit</code> = <code class="literal">true</code>的项表示列在整个继承树上的统计数据，即通过<code class="literal">SELECT <em class="replaceable"><code>column</code></em> FROM <em class="replaceable"><code>table</code></em>*</code>看到的数据的统计，而<code class="structfield">stainherit</code> = <code class="literal">false</code>的项表示对<code class="literal">SELECT <em class="replaceable"><code>column</code></em> FROM ONLY <em class="replaceable"><code>table</code></em></code>的结果的统计。
  </p><p>
   <code class="structname">pg_statistic</code>也存储关于索引表达式值的统计数据，就好像它们是真正的数据列，但在这种情况中<code class="structfield">starelid</code>指索引。对一个普通非表达式索引列不会创建项，因为它将是底层表列的项的冗余。当前，索引表达式的项都具有<code class="structfield">stainherit</code> = <code class="literal">false</code>。
  </p><p>
   因为不同类型的统计信息适用于不同类型的数据， <code class="structname">pg_statistic</code> 被设计成不太在意自己存储的是什么类型的统计。 只有极为常用的统计信息（比如NULL的含量）才在<code class="structname">pg_statistic</code>里给予专用的字段。 其它所有东西都存储在<span class="quote">“<span class="quote">槽位</span>”</span>中，而槽位是一组相关的列， 它们的内容用槽位中的一个列里的代码表示。 更详细的信息请参阅 <code class="filename">src/include/catalog/pg_statistic.h</code>。
  </p><p>
   <code class="structname">pg_statistic</code>不应该是公共可读的，因为即使是一个表内容的统计性信息也可能被认为是敏感的（例子：一个薪水列的最大和最小值可能是非常有趣的）。<a class="link" href="view-pg-stats.html" title="51.88. pg_stats"><code class="structname">pg_stats</code></a>是<code class="structname">pg_statistic</code>上的一个公共可读的视图，它只会显示出当前用户可读的表的信息。
  </p><div class="table" id="id-1.10.4.52.8"><p class="title"><strong>表 51.50. <code class="structname">pg_statistic</code>的列</strong></p><div class="table-contents"><table class="table" summary="pg_statistic的列" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>名称</th><th>类型</th><th>引用</th><th>描述</th></tr></thead><tbody><tr><td><code class="structfield">starelid</code></td><td><code class="type">oid</code></td><td><code class="literal"><a class="link" href="catalog-pg-class.html" title="51.11. pg_class"><code class="structname">pg_class</code></a>.oid</code></td><td>被描述列所属的表或索引</td></tr><tr><td><code class="structfield">staattnum</code></td><td><code class="type">int2</code></td><td><code class="literal"><a class="link" href="catalog-pg-attribute.html" title="51.7. pg_attribute"><code class="structname">pg_attribute</code></a>.attnum</code></td><td>被描述列的编号</td></tr><tr><td><code class="structfield">stainherit</code></td><td><code class="type">bool</code></td><td> </td><td>如果为真，统计包含了继承后代的列而不仅仅是指定关系的列</td></tr><tr><td><code class="structfield">stanullfrac</code></td><td><code class="type">float4</code></td><td> </td><td>列的项为空的比例</td></tr><tr><td><code class="structfield">stawidth</code></td><td><code class="type">int4</code></td><td> </td><td>非空项的平均存储宽度，以字节计</td></tr><tr><td><code class="structfield">stadistinct</code></td><td><code class="type">float4</code></td><td> </td><td>列中非空唯一值的数目。一个大于零的值是唯一值的真正数目。一个小于零的值是表中行数的乘数的负值；例如，对于一个 80% 的值为非空且每个非空值平均出现两次的列，可以表示为<code class="structfield">stadistinct</code> = -0.4。一个0值表示唯一值的数目未知。
      </td></tr><tr><td><code class="structfield">stakind<em class="replaceable"><code>N</code></em></code></td><td><code class="type">int2</code></td><td> </td><td>
       一个代码，它表示存储在该<code class="structname">pg_statistic</code>行中第<em class="replaceable"><code>N</code></em>个<span class="quote">“<span class="quote">槽位</span>”</span>的统计类型。
      </td></tr><tr><td><code class="structfield">staop<em class="replaceable"><code>N</code></em></code></td><td><code class="type">oid</code></td><td><code class="literal"><a class="link" href="catalog-pg-operator.html" title="51.34. pg_operator"><code class="structname">pg_operator</code></a>.oid</code></td><td>
       一个用于生成这些存储在第<em class="replaceable"><code>N</code></em>个<span class="quote">“<span class="quote">槽位</span>”</span>的统计信息的操作符。 比如，一个柱面图槽位会用<code class="literal">&lt;</code>操作符，该操作符定义了该数据的排序顺序。
      </td></tr><tr><td><code class="structfield">stacoll<em class="replaceable"><code>N</code></em></code></td><td><code class="type">oid</code></td><td><code class="literal"><a class="link" href="catalog-pg-collation.html" title="51.12. pg_collation"><code class="structname">pg_collation</code></a>.oid</code></td><td>
       排序规则用于导出存储在第<em class="replaceable"><code>N</code></em>个<span class="quote">“<span class="quote">槽</span>”</span>中的统计信息。例如，可排序列的直方图槽将显示定义数据排序顺序的排序规则。对于不可整理数据，为零。
      </td></tr><tr><td><code class="structfield">stanumbers<em class="replaceable"><code>N</code></em></code></td><td><code class="type">float4[]</code></td><td> </td><td>
       第<em class="replaceable"><code>N</code></em>个<span class="quote">“<span class="quote">槽位</span>”</span>的类型的数值类型统计， 如果该槽位不涉及数值类型则为NULL
      </td></tr><tr><td><code class="structfield">stavalues<em class="replaceable"><code>N</code></em></code></td><td><code class="type">anyarray</code></td><td> </td><td>
        第<em class="replaceable"><code>N</code></em>个<span class="quote">“<span class="quote">槽位</span>”</span>的类型的列值，如果该槽位类型不存储任何数据值则为 NULL。 每个数组的元素值实际上都是指定列的数据类型或者是一个相关类型（如数组元素类型）， 因此，除了把这些列的类型定义成<code class="type">anyarray</code>之外别无他法。
      </td></tr></tbody></table></div></div><br class="table-break" /></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="catalog-pg-shseclabel.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="catalogs.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="catalog-pg-statistic-ext.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">51.49. <code class="structname">pg_shseclabel</code> </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 51.51. <code class="structname">pg_statistic_ext</code></td></tr></table></div></body></html>