<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>6.2. 更新数据</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="dml-insert.html" title="6.1. 插入数据" /><link rel="next" href="dml-delete.html" title="6.3. 删除数据" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">6.2. 更新数据</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="dml-insert.html" title="6.1. 插入数据">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="dml.html" title="第 6 章 数据操纵">上一级</a></td><th width="60%" align="center">第 6 章 数据操纵</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 12.2 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="dml-delete.html" title="6.3. 删除数据">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="DML-UPDATE"><div class="titlepage"><div><div><h2 class="title" style="clear: both">6.2. 更新数据</h2></div></div></div><a id="id-1.5.5.4.2" class="indexterm"></a><a id="id-1.5.5.4.3" class="indexterm"></a><p>
   修改已经存储在数据库中的数据的行为叫做更新。你可以更新单个行，也可以更新表中所有的行，还可以更新其中的一部分行。 我们可以独立地更新每个列，而其他的列则不受影响。
  </p><p>
   要更新现有的行，使用<a class="xref" href="sql-update.html" title="UPDATE"><span class="refentrytitle">UPDATE</span></a>命令。这需要提供三部分信息：
   </p><div class="orderedlist"><ol class="orderedlist compact" type="1"><li class="listitem"><p>表的名字和要更新的列名</p></li><li class="listitem"><p>列的新值</p></li><li class="listitem"><p>要更新的是哪（些）行</p></li></ol></div><p>
  </p><p>
   我们在<a class="xref" href="ddl.html" title="第 5 章 数据定义">第 5 章</a>里说过，SQL 通常并不为行提供唯一标识符。因此我们无法总是直接指定需要更新哪一行。但是，我们可以通过指定一个被更新的行必须满足的条件。只有在表里面存在主键的时候（不管你声明它还是不声明它），我们才能可靠地通过选择一个匹配主键的条件来指定一个独立的行。图形化的数据库访问工具就靠这允许我们独立地更新某些行。
  </p><p>
   例如，这条命令把所有价格为5的产品的价格更新为10：
</p><pre class="programlisting">
UPDATE products SET price = 10 WHERE price = 5;
</pre><p>
    这样做可能导致零行、一行或者更多行被更新。如果我们试图做一个不匹配任何行的更新，那也不算错误。
  </p><p>
   让我们仔细看看这个命令。首先是关键字<code class="literal">UPDATE</code>， 然后跟着表名字。和平常一样，表名字也可以是用模式限定的， 否则会从路径中查找它。然后是关键字<code class="literal">SET</code>， 后面跟着列名、一个等号以及新的列值。新的列值可以是任意标量表达式， 而不仅仅是常量。例如，如果你想把所有产品的价格提高 10%，你可以用：
</p><pre class="programlisting">
UPDATE products SET price = price * 1.10;
</pre><p>
   如你所见，用于新值的表达式也可以引用行中现有的值。我们还忽略了<code class="literal">WHERE</code>子句。如果我们忽略了这个子句， 那么就意味着表中的所有行都要被更新。如果出现了<code class="literal">WHERE</code>子句， 那么只有匹配它后面的条件的行被更新。请注意在<code class="literal">SET</code>子句中的等号是一个赋值， 而在<code class="literal">WHERE</code>子句中的等号是比较，不过这样并不会导致任何歧义。当然<code class="literal">WHERE</code>条件不一定非得是等值测试。许多其他操作符也都可以使用（参阅<a class="xref" href="functions.html" title="第 9 章 函数和操作符">第 9 章</a>）。但是表达式必须得出一个布尔结果。
  </p><p>
   你还可以在一个<code class="command">UPDATE</code>命令中更新更多的列， 方法是在<code class="literal">SET</code>子句中列出更多赋值。例如：
</p><pre class="programlisting">
UPDATE mytable SET a = 5, b = 3, c = 1 WHERE a &gt; 0;
</pre><p>
  </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="dml-insert.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="dml.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="dml-delete.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">6.1. 插入数据 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 6.3. 删除数据</td></tr></table></div></body></html>