<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>9.5. 二进制串函数和操作符</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="functions-string.html" title="9.4. 字符串函数和操作符" /><link rel="next" href="functions-bitstring.html" title="9.6. 位串函数和操作符" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">9.5. 二进制串函数和操作符</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="functions-string.html" title="9.4. 字符串函数和操作符">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="functions.html" title="第 9 章 函数和操作符">上一级</a></td><th width="60%" align="center">第 9 章 函数和操作符</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 12.2 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="functions-bitstring.html" title="9.6. 位串函数和操作符">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="FUNCTIONS-BINARYSTRING"><div class="titlepage"><div><div><h2 class="title" style="clear: both">9.5. 二进制串函数和操作符</h2></div></div></div><a id="id-1.5.8.10.2" class="indexterm"></a><p>
    本节描述那些检查和操作类型为<code class="type">bytea</code>的值的函数和操作符。
   </p><p>
    <acronym class="acronym">SQL</acronym>定义了一些使用关键字而不是逗号来分割参数的串函数。详情请见<a class="xref" href="functions-binarystring.html#FUNCTIONS-BINARYSTRING-SQL" title="表 9.12. SQL二进制串函数和操作符">表 9.12</a>。<span class="productname">PostgreSQL</span>也提供了这些函数使用常规函数调用语法的版本（参阅<a class="xref" href="functions-binarystring.html#FUNCTIONS-BINARYSTRING-OTHER" title="表 9.13. 其他二进制串函数">表 9.13</a>）。
   </p><div class="note"><h3 class="title">注意</h3><p>
     本页中显示的示例结果假设服务器参数<a class="link" href="runtime-config-client.html#GUC-BYTEA-OUTPUT"><code class="varname">bytea_output</code></a>被设置为<code class="literal">escape</code>（传统PostgreSQL格式）。
    </p></div><div class="table" id="FUNCTIONS-BINARYSTRING-SQL"><p class="title"><strong>表 9.12. <acronym class="acronym">SQL</acronym>二进制串函数和操作符</strong></p><div class="table-contents"><table class="table" summary="SQL二进制串函数和操作符" border="1"><colgroup><col /><col /><col /><col /><col /></colgroup><thead><tr><th>函数</th><th>返回类型</th><th>描述</th><th>例子</th><th>结果</th></tr></thead><tbody><tr><td><code class="literal"><em class="parameter"><code>string</code></em> <code class="literal">||</code>
        <em class="parameter"><code>string</code></em></code></td><td> <code class="type">bytea</code> </td><td>
        串连接
        <a id="id-1.5.8.10.6.2.2.1.3.1" class="indexterm"></a>
       </td><td><code class="literal">'\\Post'::bytea || '\047gres\\000'::bytea</code></td><td><code class="literal">\\Post'gres\000</code></td></tr><tr><td>
        <a id="id-1.5.8.10.6.2.2.2.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">octet_length(<em class="parameter"><code>string</code></em>)</code></code>
       </td><td><code class="type">int</code></td><td>二进制串中的字节数</td><td><code class="literal">octet_length('jo\000se'::bytea)</code></td><td><code class="literal">5</code></td></tr><tr><td>
        <a id="id-1.5.8.10.6.2.2.3.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">overlay(<em class="parameter"><code>string</code></em> placing <em class="parameter"><code>string</code></em> from <code class="type">int</code> [<span class="optional">for <code class="type">int</code></span>])</code></code>
       </td><td><code class="type">bytea</code></td><td>
        替换子串
       </td><td><code class="literal">overlay('Th\000omas'::bytea placing '\002\003'::bytea from 2 for 3)</code></td><td><code class="literal">T\\002\\003mas</code></td></tr><tr><td>
        <a id="id-1.5.8.10.6.2.2.4.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">position(<em class="parameter"><code>substring</code></em> in <em class="parameter"><code>string</code></em>)</code></code>
       </td><td><code class="type">int</code></td><td>指定子串的位置</td><td><code class="literal">position('\000om'::bytea in 'Th\000omas'::bytea)</code></td><td><code class="literal">3</code></td></tr><tr><td>
        <a id="id-1.5.8.10.6.2.2.5.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">substring(<em class="parameter"><code>string</code></em> [<span class="optional">from <code class="type">int</code></span>] [<span class="optional">for <code class="type">int</code></span>])</code></code>
       </td><td><code class="type">bytea</code></td><td>
        提取子串
       </td><td><code class="literal">substring('Th\000omas'::bytea from 2 for 3)</code></td><td><code class="literal">h\000o</code></td></tr><tr><td>
        <a id="id-1.5.8.10.6.2.2.6.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">trim([<span class="optional">both</span>]
        <em class="parameter"><code>bytes</code></em> from
        <em class="parameter"><code>string</code></em>)</code></code>
       </td><td><code class="type">bytea</code></td><td>
        从<em class="parameter"><code>string</code></em>的开头或结尾删除只包含出现在<em class="parameter"><code>bytes</code></em>中字节的最长串
       </td><td><code class="literal">trim('\000\001'::bytea from '\000Tom\001'::bytea)</code></td><td><code class="literal">Tom</code></td></tr></tbody></table></div></div><br class="table-break" /><p>
    还有一些二进制串处理函数可以使用，在<a class="xref" href="functions-binarystring.html#FUNCTIONS-BINARYSTRING-OTHER" title="表 9.13. 其他二进制串函数">表 9.13</a>列出。 其中有一些是在内部使用，用于实现<a class="xref" href="functions-binarystring.html#FUNCTIONS-BINARYSTRING-SQL" title="表 9.12. SQL二进制串函数和操作符">表 9.12</a>列出的 SQL 标准串函数。
   </p><div class="table" id="FUNCTIONS-BINARYSTRING-OTHER"><p class="title"><strong>表 9.13. 其他二进制串函数</strong></p><div class="table-contents"><table class="table" summary="其他二进制串函数" border="1"><colgroup><col /><col /><col /><col /><col /></colgroup><thead><tr><th>函数</th><th>返回类型</th><th>描述</th><th>例子</th><th>结果</th></tr></thead><tbody><tr><td>
        <a id="id-1.5.8.10.8.2.2.1.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">btrim(<em class="parameter"><code>string</code></em>
        <code class="type">bytea</code>, <em class="parameter"><code>bytes</code></em> <code class="type">bytea</code>)</code></code>
       </td><td><code class="type">bytea</code></td><td>
        从<em class="parameter"><code>string</code></em>的开头或结尾删除只由出现在<em class="parameter"><code>bytes</code></em>中字节组成的最长串
      </td><td><code class="literal">btrim('\000trim\001'::bytea, '\000\001'::bytea)</code></td><td><code class="literal">trim</code></td></tr><tr><td>
        <a id="id-1.5.8.10.8.2.2.2.1.1" class="indexterm"></a>
       <code class="literal"><code class="function">decode(<em class="parameter"><code>string</code></em> <code class="type">text</code>,
       <em class="parameter"><code>format</code></em> <code class="type">text</code>)</code></code>
      </td><td><code class="type">bytea</code></td><td>
       从<em class="parameter"><code>string</code></em>中的文本表示解码二进制数据。<em class="parameter"><code>format</code></em>的参数和在<code class="function">encode</code>中一样。
      </td><td><code class="literal">decode('123\000456', 'escape')</code></td><td><code class="literal">123\000456</code></td></tr><tr><td>
        <a id="id-1.5.8.10.8.2.2.3.1.1" class="indexterm"></a>
       <code class="literal"><code class="function">encode(<em class="parameter"><code>data</code></em> <code class="type">bytea</code>,
       <em class="parameter"><code>format</code></em> <code class="type">text</code>)</code></code>
      </td><td><code class="type">text</code></td><td>
       将二进制数据编码为一个文本表示。支持的格式有：<code class="literal">base64</code>、<code class="literal">hex</code>、<code class="literal">escape</code>。<code class="literal">escape</code>将零字节和高位组字节转换为八进制序列（<code class="literal">\</code><em class="replaceable"><code>nnn</code></em>）和双反斜线。
      </td><td><code class="literal">encode('123\000456'::bytea, 'escape')</code></td><td><code class="literal">123\000456</code></td></tr><tr><td>
        <a id="id-1.5.8.10.8.2.2.4.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">get_bit(<em class="parameter"><code>string</code></em>, <em class="parameter"><code>offset</code></em>)</code></code>
       </td><td><code class="type">int</code></td><td>
        从串中抽取位
       </td><td><code class="literal">get_bit('Th\000omas'::bytea, 45)</code></td><td><code class="literal">1</code></td></tr><tr><td>
        <a id="id-1.5.8.10.8.2.2.5.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">get_byte(<em class="parameter"><code>string</code></em>, <em class="parameter"><code>offset</code></em>)</code></code>
       </td><td><code class="type">int</code></td><td>
        从串中抽取字节
       </td><td><code class="literal">get_byte('Th\000omas'::bytea, 4)</code></td><td><code class="literal">109</code></td></tr><tr><td>
       <a id="id-1.5.8.10.8.2.2.6.1.1" class="indexterm"></a>
       <code class="literal"><code class="function">length(<em class="parameter"><code>string</code></em>)</code></code>
      </td><td><code class="type">int</code></td><td>
       二进制串的长度
       <a id="id-1.5.8.10.8.2.2.6.3.1" class="indexterm"></a>
       <a id="id-1.5.8.10.8.2.2.6.3.2" class="indexterm"></a>
      </td><td><code class="literal">length('jo\000se'::bytea)</code></td><td><code class="literal">5</code></td></tr><tr><td>
       <a id="id-1.5.8.10.8.2.2.7.1.1" class="indexterm"></a>
       <code class="literal"><code class="function">md5(<em class="parameter"><code>string</code></em>)</code></code>
      </td><td><code class="type">text</code></td><td>
       计算<em class="parameter"><code>string</code></em>的MD5哈希码，以十六进制形式返回结果
      </td><td><code class="literal">md5('Th\000omas'::bytea)</code></td><td><code class="literal">8ab2d3c9689aaf18​b4958c334c82d8b1</code></td></tr><tr><td>
        <a id="id-1.5.8.10.8.2.2.8.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">set_bit(<em class="parameter"><code>string</code></em>,
        <em class="parameter"><code>offset</code></em>, <em class="parameter"><code>newvalue</code></em>)</code></code>
       </td><td><code class="type">bytea</code></td><td>
        设置串中的位
       </td><td><code class="literal">set_bit('Th\000omas'::bytea, 45, 0)</code></td><td><code class="literal">Th\000omAs</code></td></tr><tr><td>
        <a id="id-1.5.8.10.8.2.2.9.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">set_byte(<em class="parameter"><code>string</code></em>,
        <em class="parameter"><code>offset</code></em>, <em class="parameter"><code>newvalue</code></em>)</code></code>
       </td><td><code class="type">bytea</code></td><td>
        设置串中的字节
       </td><td><code class="literal">set_byte('Th\000omas'::bytea, 4, 64)</code></td><td><code class="literal">Th\000o@as</code></td></tr><tr><td>
        <a id="id-1.5.8.10.8.2.2.10.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">sha224(<code class="type">bytea</code>)</code></code>
       </td><td><code class="type">bytea</code></td><td>
        SHA-224哈希
       </td><td><code class="literal">sha224('abc')</code></td><td><code class="literal">\x23097d223405d8228642a477bda2​55b32aadbce4bda0b3f7e36c9da7</code></td></tr><tr><td>
        <a id="id-1.5.8.10.8.2.2.11.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">sha256(<code class="type">bytea</code>)</code></code>
       </td><td><code class="type">bytea</code></td><td>
        SHA-256哈希
       </td><td><code class="literal">sha256('abc')</code></td><td><code class="literal">\xba7816bf8f01cfea414140de5dae2223​b00361a396177a9cb410ff61f20015ad</code></td></tr><tr><td>
        <a id="id-1.5.8.10.8.2.2.12.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">sha384(<code class="type">bytea</code>)</code></code>
       </td><td><code class="type">bytea</code></td><td>
        SHA-384哈希
       </td><td><code class="literal">sha384('abc')</code></td><td><code class="literal">\xcb00753f45a35e8bb5a03d699ac65007​272c32ab0eded1631a8b605a43ff5bed​8086072ba1e7cc2358baeca134c825a7</code></td></tr><tr><td>
        <a id="id-1.5.8.10.8.2.2.13.1.1" class="indexterm"></a>
        <code class="literal"><code class="function">sha512(<code class="type">bytea</code>)</code></code>
       </td><td><code class="type">bytea</code></td><td>
        SHA-512哈希
       </td><td><code class="literal">sha512('abc')</code></td><td><code class="literal">\xddaf35a193617abacc417349ae204131​12e6fa4e89a97ea20a9eeee64b55d39a​2192992a274fc1a836ba3c23a3feebbd​454d4423643ce80e2a9ac94fa54ca49f</code></td></tr></tbody></table></div></div><br class="table-break" /><p>
   <code class="function">get_byte</code>和<code class="function">set_byte</code>把一个二进制串中的一个字节计数为字节 0。<code class="function">get_bit</code>和<code class="function">set_bit</code>在每一个字节中从右边起计数位；例如位 0 是第一个字节的最低有效位，而位 15 是第二个字节的最高有效位。
  </p><p>
   注意由于历史原因，函数<code class="function">md5</code>返回的是一个十六进制编码的<code class="type">text</code>值，而SHA-2函数返回类型<code class="type">bytea</code>。可以使用函数<code class="function">encode</code>和<code class="function">decode</code>在两者之间转换，例如<code class="literal">encode(sha256('abc'), 'hex')</code>可以得到一个十六进制编码的文本表示。
  </p><p>
  参见<a class="xref" href="functions-aggregate.html" title="9.20. 聚集函数">第 9.20 节</a>中的聚集函数<code class="function">string_agg</code>以及<a class="xref" href="lo-funcs.html" title="34.4. 服务器端函数">第 34.4 节</a>中的大对象函数。
  </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="functions-string.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="functions.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="functions-bitstring.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">9.4. 字符串函数和操作符 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 9.6. 位串函数和操作符</td></tr></table></div></body></html>