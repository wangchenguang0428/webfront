<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>42.4. 表达式</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="plpgsql-declarations.html" title="42.3. 声明" /><link rel="next" href="plpgsql-statements.html" title="42.5. 基本语句" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">42.4. 表达式</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="plpgsql-declarations.html" title="42.3. 声明">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="plpgsql.html" title="第 42 章 PL/pgSQL - SQL过程语言">上一级</a></td><th width="60%" align="center">第 42 章 <span xmlns="http://www.w3.org/1999/xhtml" class="application">PL/pgSQL</span> - <acronym xmlns="http://www.w3.org/1999/xhtml" class="acronym">SQL</acronym>过程语言</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 12.2 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="plpgsql-statements.html" title="42.5. 基本语句">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="PLPGSQL-EXPRESSIONS"><div class="titlepage"><div><div><h2 class="title" style="clear: both">42.4. 表达式</h2></div></div></div><p>
     <span class="application">PL/pgSQL</span>语句中用到的所有表达式会被服务器的主<acronym class="acronym">SQL</acronym>执行器处理。例如，当你写一个这样的<span class="application">PL/pgSQL</span>语句时
</p><pre class="synopsis">
IF <em class="replaceable"><code>expression</code></em> THEN ...
</pre><p>
     <span class="application">PL/pgSQL</span>将通过给主 SQL 引擎发送一个查询
</p><pre class="synopsis">
SELECT <em class="replaceable"><code>expression</code></em>
</pre><p>
     来计算该表达式。如<a class="xref" href="plpgsql-implementation.html#PLPGSQL-VAR-SUBST" title="42.11.1. 变量替换">第 42.11.1 节</a>中所详细讨论的，在构造该<code class="command">SELECT</code>命令时，<span class="application">PL/pgSQL</span>变量名的每一次出现会被参数所替换。这允许<code class="command">SELECT</code>的查询计划仅被准备一次并且被重用于之后的对于该变量不同值的计算。因此，在一个表达式第一次被使用时实际发生的本质上是一个<code class="command">PREPARE</code>命令。例如，如果我们已经声明了两个整数变量<code class="literal">x</code>和<code class="literal">y</code>，并且我们写了
</p><pre class="programlisting">
IF x &lt; y THEN ...
</pre><p>
     在现象之后发生的等效于
</p><pre class="programlisting">
PREPARE <em class="replaceable"><code>statement_name</code></em>(integer, integer) AS SELECT $1 &lt; $2;
</pre><p>
     并且然后为每一次<code class="command">IF</code>语句的执行，这个预备语句都会被<code class="command">EXECUTE</code>，执行时使用变量的当前值作为参数值。通常这些细节对于一个<span class="application">PL/pgSQL</span>用户并不重要，但是在尝试诊断一个问题时了解它们很有用。更多信息可见<a class="xref" href="plpgsql-implementation.html#PLPGSQL-PLAN-CACHING" title="42.11.2. 计划缓存">第 42.11.2 节</a>。
    </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="plpgsql-declarations.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="plpgsql.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="plpgsql-statements.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">42.3. 声明 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 42.5. 基本语句</td></tr></table></div></body></html>