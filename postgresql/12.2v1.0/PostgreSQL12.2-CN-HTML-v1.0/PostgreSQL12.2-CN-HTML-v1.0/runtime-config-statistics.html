<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>19.9. 运行时统计数据</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="runtime-config-logging.html" title="19.8. 错误报告和日志" /><link rel="next" href="runtime-config-autovacuum.html" title="19.10. 自动清理" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">19.9. 运行时统计数据</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="runtime-config-logging.html" title="19.8. 错误报告和日志">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="runtime-config.html" title="第 19 章 服务器配置">上一级</a></td><th width="60%" align="center">第 19 章 服务器配置</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 12.2 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="runtime-config-autovacuum.html" title="19.10. 自动清理">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="RUNTIME-CONFIG-STATISTICS"><div class="titlepage"><div><div><h2 class="title" style="clear: both">19.9. 运行时统计数据</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="runtime-config-statistics.html#RUNTIME-CONFIG-STATISTICS-COLLECTOR">19.9.1. 查询和索引统计收集器</a></span></dt><dt><span class="sect2"><a href="runtime-config-statistics.html#RUNTIME-CONFIG-STATISTICS-MONITOR">19.9.2. 统计监控</a></span></dt></dl></div><div class="sect2" id="RUNTIME-CONFIG-STATISTICS-COLLECTOR"><div class="titlepage"><div><div><h3 class="title">19.9.1. 查询和索引统计收集器</h3></div></div></div><p>
      这些参数控制服务器范围的统计数据收集特性。当统计收集被启用时，被产生的数据可以通过<code class="structname">pg_stat</code>和<code class="structname">pg_statio</code>系统视图族访问。详见<a class="xref" href="monitoring.html" title="第 27 章 监控数据库活动">第 27 章</a>。
     </p><div class="variablelist"><dl class="variablelist"><dt id="GUC-TRACK-ACTIVITIES"><span class="term"><code class="varname">track_activities</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.12.2.3.1.1.3" class="indexterm"></a>
      </span></dt><dd><p>
        启用对每个会话的当前执行命令的信息收集，还有命令开始执行的时间。这个参数默认为打开。注意即使被启用，这些信息也不是对所有用户可见，只有超级用户和拥有报告信息的会话的用户可见，因此它不会表现为一个安全风险。只有超级用户可以更改这个设置。
       </p></dd><dt id="GUC-TRACK-ACTIVITY-QUERY-SIZE"><span class="term"><code class="varname">track_activity_query_size</code> (<code class="type">integer</code>)
      <a id="id-1.6.6.12.2.3.2.1.3" class="indexterm"></a>
      </span></dt><dd><p>
       为每个活动会话指定存储当前执行命令的文本所保留的内存量，它们被用于<code class="structname">pg_stat_activity</code>.<code class="structfield">query</code>域。
       如果指定值时没有单位，则以字节为单位。默认值是 1024字节。这个参数只能在服务器启动时被设置。  
       </p></dd><dt id="GUC-TRACK-COUNTS"><span class="term"><code class="varname">track_counts</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.12.2.3.3.1.3" class="indexterm"></a>
      </span></dt><dd><p>
        启用在数据库活动上的统计收集。这个参数默认为打开，因为自动清理守护进程需要被收集的信息。只有超级用户可以更改这个设置。
       </p></dd><dt id="GUC-TRACK-IO-TIMING"><span class="term"><code class="varname">track_io_timing</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.12.2.3.4.1.3" class="indexterm"></a>
      </span></dt><dd><p>
        启用对系统 I/O 调用的计时。这个参数默认为关闭，因为它将重复地向操作系统查询当前时间，这会在某些平台上导致显著的负荷。你可以使用<a class="xref" href="pgtesttiming.html" title="pg_test_timing"><span class="refentrytitle"><span class="application">pg_test_timing</span></span></a>工具来度量你的系统中计时的开销。I/O 计时信息被显示在<a class="xref" href="monitoring-stats.html#PG-STAT-DATABASE-VIEW" title="表 27.12. pg_stat_database视图">pg_stat_database</a>中、当<code class="literal">BUFFERS</code>选项被使用时的<a class="xref" href="sql-explain.html" title="EXPLAIN"><span class="refentrytitle">EXPLAIN</span></a>输出中以及<a class="xref" href="pgstatstatements.html" title="F.29. pg_stat_statements">pg_stat_statements</a>中。只有超级用户可以更改这个设置。
       </p></dd><dt id="GUC-TRACK-FUNCTIONS"><span class="term"><code class="varname">track_functions</code> (<code class="type">enum</code>)
      <a id="id-1.6.6.12.2.3.5.1.3" class="indexterm"></a>
      </span></dt><dd><p>
        启用跟踪函数调用计数和用时。指定<code class="literal">pl</code>只跟踪过程语言函数，指定<code class="literal">all</code>还会跟踪 SQL 和 C 语言函数。默认值是<code class="literal">none</code>，它禁用函数统计跟踪。只有超级用户可以更改这个设置。
       </p><div class="note"><h3 class="title">注意</h3><p>
         简单到足以被<span class="quote">“<span class="quote">内联</span>”</span>到调用查询中的 SQL 语言函数不会被跟踪， 而不管这个设置。
        </p></div></dd><dt id="GUC-STATS-TEMP-DIRECTORY"><span class="term"><code class="varname">stats_temp_directory</code> (<code class="type">string</code>)
      <a id="id-1.6.6.12.2.3.6.1.3" class="indexterm"></a>
      </span></dt><dd><p>
        设置存储临时统计数据的目录。这可以是一个相对于数据目录的路径或一个绝对路径。默认值是<code class="filename">pg_stat_tmp</code>。在一个基于 RAM 的文件系统上指明这个参数将降低物理 I/O 需求，并且提高性能。这个参数只能在<code class="filename">postgresql.conf</code>文件中或在服务器命令行上设置。
       </p></dd></dl></div></div><div class="sect2" id="RUNTIME-CONFIG-STATISTICS-MONITOR"><div class="titlepage"><div><div><h3 class="title">19.9.2. 统计监控</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="varname">log_statement_stats</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.12.3.2.1.1.3" class="indexterm"></a>
      <br /></span><span class="term"><code class="varname">log_parser_stats</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.12.3.2.1.2.3" class="indexterm"></a>
      <br /></span><span class="term"><code class="varname">log_planner_stats</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.12.3.2.1.3.3" class="indexterm"></a>
      <br /></span><span class="term"><code class="varname">log_executor_stats</code> (<code class="type">boolean</code>)
      <a id="id-1.6.6.12.3.2.1.4.3" class="indexterm"></a>
      </span></dt><dd><p>
        对每个查询，向服务器日志里输出相应模块的性能统计。这是一种粗糙的分析工具。类似于 Unix 的<code class="function">getrusage()</code>系统功能。<code class="varname">log_statement_stats</code>报告总的语句统计，而其它的报告针每个模块的统计。<code class="varname">log_statement_stats</code>不能和 其它任何针对每个模块统计的选项一起启用。所有这些选项都是默认禁用的。只有超级用户可以更改这个设置。
       </p></dd></dl></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="runtime-config-logging.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="runtime-config.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="runtime-config-autovacuum.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">19.8. 错误报告和日志 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 19.10. 自动清理</td></tr></table></div></body></html>