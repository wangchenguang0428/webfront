<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>7.5. 行排序</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="queries-union.html" title="7.4. 组合查询" /><link rel="next" href="queries-limit.html" title="7.6. LIMIT和OFFSET" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">7.5. 行排序</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="queries-union.html" title="7.4. 组合查询">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="queries.html" title="第 7 章 查询">上一级</a></td><th width="60%" align="center">第 7 章 查询</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 12.2 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="queries-limit.html" title="7.6. LIMIT和OFFSET">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="QUERIES-ORDER"><div class="titlepage"><div><div><h2 class="title" style="clear: both">7.5. 行排序</h2></div></div></div><a id="id-1.5.6.9.2" class="indexterm"></a><a id="id-1.5.6.9.3" class="indexterm"></a><p>
   在一个查询生成一个输出表之后（在处理完选择列表之后），还可以选择性地对它进行排序。如果没有选择排序，那么行将以未指定的顺序返回。 这时候的实际顺序将取决于扫描和连接计划类型以及行在磁盘上的顺序，但是肯定不能依赖这些东西。一种特定的顺序只能在显式地选择了排序步骤之后才能被保证。
  </p><p>
   <code class="literal">ORDER BY</code>子句指定了排序顺序：
</p><pre class="synopsis">
SELECT <em class="replaceable"><code>select_list</code></em>
    FROM <em class="replaceable"><code>table_expression</code></em>
    ORDER BY <em class="replaceable"><code>sort_expression1</code></em> [<span class="optional">ASC | DESC</span>] [<span class="optional">NULLS { FIRST | LAST }</span>]
             [<span class="optional">, <em class="replaceable"><code>sort_expression2</code></em> [<span class="optional">ASC | DESC</span>] [<span class="optional">NULLS { FIRST | LAST }</span>] ...</span>]
</pre><p>
   排序表达式可以是任何在查询的选择列表中合法的表达式。一个例子是：
</p><pre class="programlisting">
SELECT a, b FROM table1 ORDER BY a + b, c;
</pre><p>
   当多于一个表达式被指定，后面的值将被用于排序那些在前面值上相等的行。每一个表达式后可以选择性地放置一个<code class="literal">ASC</code>或<code class="literal">DESC</code>关键词来设置排序方向为升序或降序。<code class="literal">ASC</code>顺序是默认值。升序会把较小的值放在前面，而<span class="quote">“<span class="quote">较小</span>”</span>则由<code class="literal">&lt;</code>操作符定义。相似地，降序则由<code class="literal">&gt;</code>操作符定义。
    <a href="#ftn.id-1.5.6.9.5.10" class="footnote"><sup class="footnote" id="id-1.5.6.9.5.10">[5]</sup></a>
  </p><p>
   <code class="literal">NULLS FIRST</code>和<code class="literal">NULLS LAST</code>选项将可以被用来决定在排序顺序中，空值是出现在非空值之前或者出现在非空值之后。默认情况下，排序时空值被认为比任何非空值都要大，即<code class="literal">NULLS FIRST</code>是<code class="literal">DESC</code>顺序的默认值，而不是<code class="literal">NULLS LAST</code>的默认值。
  </p><p>
   注意顺序选项是对每一个排序列独立考虑的。例如<code class="literal">ORDER BY x, y DESC</code>表示<code class="literal">ORDER BY x ASC, y DESC</code>，而和<code class="literal">ORDER BY x DESC, y DESC</code>不同。
  </p><p>
   一个<em class="replaceable"><code>sort_expression</code></em>也可以是列标签或者一个输出列的编号，如：
</p><pre class="programlisting">
SELECT a + b AS sum, c FROM table1 ORDER BY sum;
SELECT a, max(b) FROM table1 GROUP BY a ORDER BY 1;
</pre><p>
   两者都根据第一个输出列排序。注意一个输出列的名字必须孤立，即它不能被用在一个表达式中 — 例如，这是<span class="emphasis"><em>不</em></span>正确的：
</p><pre class="programlisting">
SELECT a + b AS sum, c FROM table1 ORDER BY sum + c;          -- 错误
</pre><p>
   该限制是为了减少混淆。如果一个<code class="literal">ORDER BY</code>项是一个单一名字并且匹配一个输出列名或者一个表表达式的列，仍然会出现混淆。在这种情况中输出列将被使用。只有在你使用<code class="literal">AS</code>来重命名一个输出列来匹配某些其他表列的名字时，这才会导致混淆。
  </p><p>
   <code class="literal">ORDER BY</code>可以被应用于<code class="literal">UNION</code>、<code class="literal">INTERSECT</code>或<code class="literal">EXCEPT</code>组合的结果，但是在这种情况中它只被允许根据输出列名或编号排序，而不能根据表达式排序。
  </p><div class="footnotes"><br /><hr style="width:100; text-align:left;margin-left: 0" /><div id="ftn.id-1.5.6.9.5.10" class="footnote"><p><a href="#id-1.5.6.9.5.10" class="para"><sup class="para">[5] </sup></a>
      事实上，<span class="productname">PostgreSQL</span>为表达式的数据类型使用<em class="firstterm">默认B-tree操作符类</em>来决定<code class="literal">ASC</code>和<code class="literal">DESC</code>的排序顺序。照惯例，数据类型将被建立，这样<code class="literal">&lt;</code>和<code class="literal">&gt;</code>操作符负责这个排序顺序，但是一个用户定义的数据类型的设计者可以选择做些不同的设置。
     </p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="queries-union.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="queries.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="queries-limit.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">7.4. 组合查询 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 7.6. <code class="literal">LIMIT</code>和<code class="literal">OFFSET</code></td></tr></table></div></body></html>