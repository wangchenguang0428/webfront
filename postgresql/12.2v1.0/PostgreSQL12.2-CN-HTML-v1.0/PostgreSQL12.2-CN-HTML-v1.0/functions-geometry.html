<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>9.11. 几何函数和操作符</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="functions-enum.html" title="9.10. 枚举支持函数" /><link rel="next" href="functions-net.html" title="9.12. 网络地址函数和操作符" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">9.11. 几何函数和操作符</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="functions-enum.html" title="9.10. 枚举支持函数">上一页</a> </td><td width="10%" align="left"><a accesskey="u" href="functions.html" title="第 9 章 函数和操作符">上一级</a></td><th width="60%" align="center">第 9 章 函数和操作符</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 12.2 手册">起始页</a></td><td width="10%" align="right"> <a accesskey="n" href="functions-net.html" title="9.12. 网络地址函数和操作符">下一页</a></td></tr></table><hr></hr></div><div class="sect1" id="FUNCTIONS-GEOMETRY"><div class="titlepage"><div><div><h2 class="title" style="clear: both">9.11. 几何函数和操作符</h2></div></div></div><p>
    几何类型<code class="type">point</code>、<code class="type">box</code>、
    <code class="type">lseg</code>、<code class="type">line</code>、<code class="type">path</code>、
    <code class="type">polygon</code>和<code class="type">circle</code>有一大堆本地支持函数和操作符，如<a class="xref" href="functions-geometry.html#FUNCTIONS-GEOMETRY-OP-TABLE" title="表 9.34. 几何操作符">表 9.34</a>、<a class="xref" href="functions-geometry.html#FUNCTIONS-GEOMETRY-FUNC-TABLE" title="表 9.35. 几何函数">表 9.35</a>和<a class="xref" href="functions-geometry.html#FUNCTIONS-GEOMETRY-CONV-TABLE" title="表 9.36. 几何类型转换函数">表 9.36</a>中所示。
   </p><div class="caution"><h3 class="title">小心</h3><p>
     请注意<span class="quote">“<span class="quote">same as</span>”</span>操作符（<code class="literal">~=</code>），表示<code class="type">point</code>、<code class="type">box</code>、<code class="type">polygon</code>和<code class="type">circle</code>类型的一般相等概念。这些类型中的某些还有一个<code class="literal">=</code>操作符，但是<code class="literal">=</code>只比较相同的<span class="emphasis"><em>面积</em></span>。其它的标量比较操作符 （<code class="literal">&lt;=</code>等等）也是为这些类型比较面积。
    </p></div><div class="table" id="FUNCTIONS-GEOMETRY-OP-TABLE"><p class="title"><strong>表 9.34. 几何操作符</strong></p><div class="table-contents"><table class="table" summary="几何操作符" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>操作符</th><th>描述</th><th>例子</th></tr></thead><tbody><tr><td> <code class="literal">+</code> </td><td>平移</td><td><code class="literal">box '((0,0),(1,1))' + point '(2.0,0)'</code></td></tr><tr><td> <code class="literal">-</code> </td><td>平移</td><td><code class="literal">box '((0,0),(1,1))' - point '(2.0,0)'</code></td></tr><tr><td> <code class="literal">*</code> </td><td>缩放/旋转</td><td><code class="literal">box '((0,0),(1,1))' * point '(2.0,0)'</code></td></tr><tr><td> <code class="literal">/</code> </td><td>缩放/旋转</td><td><code class="literal">box '((0,0),(2,2))' / point '(2.0,0)'</code></td></tr><tr><td> <code class="literal">#</code> </td><td>相交的点或方框</td><td><code class="literal">box '((1,-1),(-1,1))' # box '((1,1),(-2,-2))'</code></td></tr><tr><td> <code class="literal">#</code> </td><td>路径或多边形中的点数</td><td><code class="literal"># path '((1,0),(0,1),(-1,0))'</code></td></tr><tr><td> <code class="literal">@-@</code> </td><td>长度或周长</td><td><code class="literal">@-@ path '((0,0),(1,0))'</code></td></tr><tr><td> <code class="literal">@@</code> </td><td>中心</td><td><code class="literal">@@ circle '((0,0),10)'</code></td></tr><tr><td> <code class="literal">##</code> </td><td>第二个操作数上最接近第一个操作数的点</td><td><code class="literal">point '(0,0)' ## lseg '((2,0),(0,2))'</code></td></tr><tr><td> <code class="literal">&lt;-&gt;</code> </td><td>距离</td><td><code class="literal">circle '((0,0),1)' &lt;-&gt; circle '((5,0),1)'</code></td></tr><tr><td> <code class="literal">&amp;&amp;</code> </td><td>是否重叠？（只要有一个公共点这就为真）</td><td><code class="literal">box '((0,0),(1,1))' &amp;&amp; box '((0,0),(2,2))'</code></td></tr><tr><td> <code class="literal">&lt;&lt;</code> </td><td>是否严格地在左侧？</td><td><code class="literal">circle '((0,0),1)' &lt;&lt; circle '((5,0),1)'</code></td></tr><tr><td> <code class="literal">&gt;&gt;</code> </td><td>是否严格地在右侧？</td><td><code class="literal">circle '((5,0),1)' &gt;&gt; circle '((0,0),1)'</code></td></tr><tr><td> <code class="literal">&amp;&lt;</code> </td><td>没有延展到右边？</td><td><code class="literal">box '((0,0),(1,1))' &amp;&lt; box '((0,0),(2,2))'</code></td></tr><tr><td> <code class="literal">&amp;&gt;</code> </td><td>没有延展到左边？</td><td><code class="literal">box '((0,0),(3,3))' &amp;&gt; box '((0,0),(2,2))'</code></td></tr><tr><td> <code class="literal">&lt;&lt;|</code> </td><td>严格在下？</td><td><code class="literal">box '((0,0),(3,3))' &lt;&lt;| box '((3,4),(5,5))'</code></td></tr><tr><td> <code class="literal">|&gt;&gt;</code> </td><td>严格在上？</td><td><code class="literal">box '((3,4),(5,5))' |&gt;&gt; box '((0,0),(3,3))'</code></td></tr><tr><td> <code class="literal">&amp;&lt;|</code> </td><td>没有延展到上面？</td><td><code class="literal">box '((0,0),(1,1))' &amp;&lt;| box '((0,0),(2,2))'</code></td></tr><tr><td> <code class="literal">|&amp;&gt;</code> </td><td>没有延展到下面？</td><td><code class="literal">box '((0,0),(3,3))' |&amp;&gt; box '((0,0),(2,2))'</code></td></tr><tr><td> <code class="literal">&lt;^</code> </td><td>在下面（允许相切）？</td><td><code class="literal">circle '((0,0),1)' &lt;^ circle '((0,5),1)'</code></td></tr><tr><td> <code class="literal">&gt;^</code> </td><td>在上面（允许相切）？</td><td><code class="literal">circle '((0,5),1)' &gt;^ circle '((0,0),1)'</code></td></tr><tr><td> <code class="literal">?#</code> </td><td>相交？</td><td><code class="literal">lseg '((-1,0),(1,0))' ?# box '((-2,-2),(2,2))'</code></td></tr><tr><td> <code class="literal">?-</code> </td><td>水平？</td><td><code class="literal">?- lseg '((-1,0),(1,0))'</code></td></tr><tr><td> <code class="literal">?-</code> </td><td>水平对齐？</td><td><code class="literal">point '(1,0)' ?- point '(0,0)'</code></td></tr><tr><td> <code class="literal">?|</code> </td><td>垂直？</td><td><code class="literal">?| lseg '((-1,0),(1,0))'</code></td></tr><tr><td> <code class="literal">?|</code> </td><td>垂直对齐？</td><td><code class="literal">point '(0,1)' ?| point '(0,0)'</code></td></tr><tr><td> <code class="literal">?-|</code> </td><td>相互垂直？</td><td><code class="literal">lseg '((0,0),(0,1))' ?-| lseg '((0,0),(1,0))'</code></td></tr><tr><td> <code class="literal">?||</code> </td><td>平行？</td><td><code class="literal">lseg '((-1,0),(1,0))' ?|| lseg '((-1,2),(1,2))'</code></td></tr><tr><td> <code class="literal">@&gt;</code> </td><td>包含？</td><td><code class="literal">circle '((0,0),2)' @&gt; point '(1,1)'</code></td></tr><tr><td> <code class="literal">&lt;@</code> </td><td>包含在内或在上？</td><td><code class="literal">point '(1,1)' &lt;@ circle '((0,0),2)'</code></td></tr><tr><td> <code class="literal">~=</code> </td><td>相同？</td><td><code class="literal">polygon '((0,0),(1,1))' ~= polygon '((1,1),(0,0))'</code></td></tr></tbody></table></div></div><br class="table-break" /><div class="note"><h3 class="title">注意</h3><p>
     在<span class="productname">PostgreSQL</span>之前，包含操作符<code class="literal">@&gt;</code>和<code class="literal">&lt;@</code>被分别称为<code class="literal">~</code>和<code class="literal">@</code>。 这些名字仍然可以使用，但是已被废除并且最终将被移除。
    </p></div><a id="id-1.5.8.16.6" class="indexterm"></a><a id="id-1.5.8.16.7" class="indexterm"></a><a id="id-1.5.8.16.8" class="indexterm"></a><a id="id-1.5.8.16.9" class="indexterm"></a><a id="id-1.5.8.16.10" class="indexterm"></a><a id="id-1.5.8.16.11" class="indexterm"></a><a id="id-1.5.8.16.12" class="indexterm"></a><a id="id-1.5.8.16.13" class="indexterm"></a><a id="id-1.5.8.16.14" class="indexterm"></a><a id="id-1.5.8.16.15" class="indexterm"></a><a id="id-1.5.8.16.16" class="indexterm"></a><a id="id-1.5.8.16.17" class="indexterm"></a><div class="table" id="FUNCTIONS-GEOMETRY-FUNC-TABLE"><p class="title"><strong>表 9.35. 几何函数</strong></p><div class="table-contents"><table class="table" summary="几何函数" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>函数</th><th>返回类型</th><th>描述</th><th>例子</th></tr></thead><tbody><tr><td><code class="literal"><code class="function">area(<em class="replaceable"><code>object</code></em>)</code></code></td><td><code class="type">double precision</code></td><td>面积</td><td><code class="literal">area(box '((0,0),(1,1))')</code></td></tr><tr><td><code class="literal"><code class="function">center(<em class="replaceable"><code>object</code></em>)</code></code></td><td><code class="type">point</code></td><td>中心</td><td><code class="literal">center(box '((0,0),(1,2))')</code></td></tr><tr><td><code class="literal"><code class="function">diameter(<code class="type">circle</code>)</code></code></td><td><code class="type">double precision</code></td><td>圆的直径</td><td><code class="literal">diameter(circle '((0,0),2.0)')</code></td></tr><tr><td><code class="literal"><code class="function">height(<code class="type">box</code>)</code></code></td><td><code class="type">double precision</code></td><td>方框的垂直尺寸</td><td><code class="literal">height(box '((0,0),(1,1))')</code></td></tr><tr><td><code class="literal"><code class="function">isclosed(<code class="type">path</code>)</code></code></td><td><code class="type">boolean</code></td><td>一个封闭路径？</td><td><code class="literal">isclosed(path '((0,0),(1,1),(2,0))')</code></td></tr><tr><td><code class="literal"><code class="function">isopen(<code class="type">path</code>)</code></code></td><td><code class="type">boolean</code></td><td>一个开放路径？</td><td><code class="literal">isopen(path '[(0,0),(1,1),(2,0)]')</code></td></tr><tr><td><code class="literal"><code class="function">length(<em class="replaceable"><code>object</code></em>)</code></code></td><td><code class="type">double precision</code></td><td>长度</td><td><code class="literal">length(path '((-1,0),(1,0))')</code></td></tr><tr><td><code class="literal"><code class="function">npoints(<code class="type">path</code>)</code></code></td><td><code class="type">int</code></td><td>点数</td><td><code class="literal">npoints(path '[(0,0),(1,1),(2,0)]')</code></td></tr><tr><td><code class="literal"><code class="function">npoints(<code class="type">polygon</code>)</code></code></td><td><code class="type">int</code></td><td>点数</td><td><code class="literal">npoints(polygon '((1,1),(0,0))')</code></td></tr><tr><td><code class="literal"><code class="function">pclose(<code class="type">path</code>)</code></code></td><td><code class="type">path</code></td><td>将路径转换成封闭的</td><td><code class="literal">pclose(path '[(0,0),(1,1),(2,0)]')</code></td></tr><tr><td><code class="literal"><code class="function">popen(<code class="type">path</code>)</code></code></td><td><code class="type">path</code></td><td>将路径转换成开放</td><td><code class="literal">popen(path '((0,0),(1,1),(2,0))')</code></td></tr><tr><td><code class="literal"><code class="function">radius(<code class="type">circle</code>)</code></code></td><td><code class="type">double precision</code></td><td>圆的半径</td><td><code class="literal">radius(circle '((0,0),2.0)')</code></td></tr><tr><td><code class="literal"><code class="function">width(<code class="type">box</code>)</code></code></td><td><code class="type">double precision</code></td><td>方框的水平尺寸</td><td><code class="literal">width(box '((0,0),(1,1))')</code></td></tr></tbody></table></div></div><br class="table-break" /><div class="table" id="FUNCTIONS-GEOMETRY-CONV-TABLE"><p class="title"><strong>表 9.36. 几何类型转换函数</strong></p><div class="table-contents"><table class="table" summary="几何类型转换函数" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>函数</th><th>返回类型</th><th>描述</th><th>例子</th></tr></thead><tbody><tr><td>
         <a id="id-1.5.8.16.19.2.2.1.1.1" class="indexterm"></a>
         <code class="literal"><code class="function">box(<code class="type">circle</code>)</code></code>
        </td><td><code class="type">box</code></td><td>圆到方框</td><td><code class="literal">box(circle '((0,0),2.0)')</code></td></tr><tr><td><code class="literal"><code class="function">box(<code class="type">point</code>)</code></code></td><td><code class="type">box</code></td><td>点到空方框</td><td><code class="literal">box(point '(0,0)')</code></td></tr><tr><td><code class="literal"><code class="function">box(<code class="type">point</code>, <code class="type">point</code>)</code></code></td><td><code class="type">box</code></td><td>点到方框</td><td><code class="literal">box(point '(0,0)', point '(1,1)')</code></td></tr><tr><td><code class="literal"><code class="function">box(<code class="type">polygon</code>)</code></code></td><td><code class="type">box</code></td><td>多边形到方框</td><td><code class="literal">box(polygon '((0,0),(1,1),(2,0))')</code></td></tr><tr><td><code class="literal"><code class="function">bound_box(<code class="type">box</code>, <code class="type">box</code>)</code></code></td><td><code class="type">box</code></td><td>方框到外包框</td><td><code class="literal">bound_box(box '((0,0),(1,1))', box '((3,3),(4,4))')</code></td></tr><tr><td>
         <a id="id-1.5.8.16.19.2.2.6.1.1" class="indexterm"></a>
         <code class="literal"><code class="function">circle(<code class="type">box</code>)</code></code>
        </td><td><code class="type">circle</code></td><td>方框到圆</td><td><code class="literal">circle(box '((0,0),(1,1))')</code></td></tr><tr><td><code class="literal"><code class="function">circle(<code class="type">point</code>, <code class="type">double precision</code>)</code></code></td><td><code class="type">circle</code></td><td>中心和半径到圆</td><td><code class="literal">circle(point '(0,0)', 2.0)</code></td></tr><tr><td><code class="literal"><code class="function">circle(<code class="type">polygon</code>)</code></code></td><td><code class="type">circle</code></td><td>多边形到圆</td><td><code class="literal">circle(polygon '((0,0),(1,1),(2,0))')</code></td></tr><tr><td><code class="literal"><code class="function">line(<code class="type">point</code>, <code class="type">point</code>)</code></code></td><td><code class="type">line</code></td><td>点到线</td><td><code class="literal">line(point '(-1,0)', point '(1,0)')</code></td></tr><tr><td>
         <a id="id-1.5.8.16.19.2.2.10.1.1" class="indexterm"></a>
         <code class="literal"><code class="function">lseg(<code class="type">box</code>)</code></code>
        </td><td><code class="type">lseg</code></td><td>方框对角线到线段</td><td><code class="literal">lseg(box '((-1,0),(1,0))')</code></td></tr><tr><td><code class="literal"><code class="function">lseg(<code class="type">point</code>, <code class="type">point</code>)</code></code></td><td><code class="type">lseg</code></td><td>点到线段</td><td><code class="literal">lseg(point '(-1,0)', point '(1,0)')</code></td></tr><tr><td>
         <a id="id-1.5.8.16.19.2.2.12.1.1" class="indexterm"></a>
         <code class="literal"><code class="function">path(<code class="type">polygon</code>)</code></code>
        </td><td><code class="type">path</code></td><td>多边形到路径</td><td><code class="literal">path(polygon '((0,0),(1,1),(2,0))')</code></td></tr><tr><td>
         <a id="id-1.5.8.16.19.2.2.13.1.1" class="indexterm"></a>
         <code class="literal"><code class="function">point</code>(<code class="type">double
         precision</code>, <code class="type">double precision</code>)</code>
        </td><td><code class="type">point</code></td><td>构造点</td><td><code class="literal">point(23.4, -44.5)</code></td></tr><tr><td><code class="literal"><code class="function">point(<code class="type">box</code>)</code></code></td><td><code class="type">point</code></td><td>方框的中心</td><td><code class="literal">point(box '((-1,0),(1,0))')</code></td></tr><tr><td><code class="literal"><code class="function">point(<code class="type">circle</code>)</code></code></td><td><code class="type">point</code></td><td>圆的中心</td><td><code class="literal">point(circle '((0,0),2.0)')</code></td></tr><tr><td><code class="literal"><code class="function">point(<code class="type">lseg</code>)</code></code></td><td><code class="type">point</code></td><td>线段的中心</td><td><code class="literal">point(lseg '((-1,0),(1,0))')</code></td></tr><tr><td><code class="literal"><code class="function">point(<code class="type">polygon</code>)</code></code></td><td><code class="type">point</code></td><td>多边形的中心</td><td><code class="literal">point(polygon '((0,0),(1,1),(2,0))')</code></td></tr><tr><td>
         <a id="id-1.5.8.16.19.2.2.18.1.1" class="indexterm"></a>
         <code class="literal"><code class="function">polygon(<code class="type">box</code>)</code></code>
        </td><td><code class="type">polygon</code></td><td>方框到4点多边形</td><td><code class="literal">polygon(box '((0,0),(1,1))')</code></td></tr><tr><td><code class="literal"><code class="function">polygon(<code class="type">circle</code>)</code></code></td><td><code class="type">polygon</code></td><td>圆到12点多边形</td><td><code class="literal">polygon(circle '((0,0),2.0)')</code></td></tr><tr><td><code class="literal"><code class="function">polygon(<em class="replaceable"><code>npts</code></em>, <code class="type">circle</code>)</code></code></td><td><code class="type">polygon</code></td><td>点到<em class="replaceable"><code>npts</code></em>点多边形</td><td><code class="literal">polygon(12, circle '((0,0),2.0)')</code></td></tr><tr><td><code class="literal"><code class="function">polygon(<code class="type">path</code>)</code></code></td><td><code class="type">polygon</code></td><td>路径到多边形</td><td><code class="literal">polygon(path '((0,0),(1,1),(2,0))')</code></td></tr></tbody></table></div></div><br class="table-break" /><p>
     我们可以把一个<code class="type">point</code>的两个组成数字当作具有索引 0 和 1 的数组访问。例如，如果<code class="literal">t.p</code>是一个<code class="type">point</code>列，那么<code class="literal">SELECT p[0] FROM t</code>检索 X 座标而 <code class="literal">UPDATE t SET p[1] = ...</code>改变 Y 座标。同样，<code class="type">box</code>或者<code class="type">lseg</code>类型的值可以当作两个<code class="type">point</code>值的数组值看待。
    </p><p>
     函数<code class="function">area</code>可以用于类型<code class="type">box</code>、<code class="type">circle</code>和<code class="type">path</code>。<code class="function">area</code>函数操作<code class="type">path</code>数据类型的时候， 只有在<code class="type">path</code>的点没有交叉的情况下才可用。例如，<code class="type">path</code> <code class="literal">'((0,0),(0,1),(2,1),(2,2),(1,2),(1,0),(0,0))'::PATH</code>是不行的， 而下面的视觉上相同的 <code class="type">path</code> <code class="literal">'((0,0),(0,1),(1,1),(1,2),(2,2),(2,1),(1,1),(1,0),(0,0))'::PATH</code>就可以。 如果交叉和不交叉的<code class="type">path</code>概念让你疑惑，那么把上面两个<code class="type">path</code>都画在一张图纸上，你就明白了。
    </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="functions-enum.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="functions.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="functions-net.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">9.10. 枚举支持函数 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 9.12. 网络地址函数和操作符</td></tr></table></div></body></html>